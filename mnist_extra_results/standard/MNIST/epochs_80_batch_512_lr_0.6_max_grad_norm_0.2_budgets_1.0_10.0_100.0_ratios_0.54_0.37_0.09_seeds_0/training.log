INFO:root:Input args: Namespace(dname='MNIST', seeds=[0], architecture='MNIST_CNN', accountant='rdp', individualize=None, log_iteration=100, lr=0.6, momentum=0.5, epochs=80, n_workers=6, batch_size=512, max_physical_batch_size=128, delta=1e-05, budgets=[1.0, 10.0, 100.0], ratios=[0.54, 0.37, 0.09], max_grad_norm=0.2, noise_multiplier=3.42529, weights=None, adapt_weights_to_budgets=True, use_cuda='True', save_path='../mnist_extra_results/standard/MNIST/epochs_80_batch_512_lr_0.6_max_grad_norm_0.2_budgets_1.0_10.0_100.0_ratios_0.54_0.37_0.09_seeds_0', mode='mia', accuracy_log='accuracy.log', assign_budget='even', class_budgets=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], mia_ndata=60000, mia_count=0, allow_excess=False, save_model='True')
INFO:root:seed: 0,   max_iteration: 9375,   1 epoch ~= 117 iterations
INFO:root:seed: 0,   max_iteration: 9375,   1 epoch ~= 117 iterations
INFO:root:Initializing privacy parameters:   max_grad_norm=0.2,   sample_rate=0.00847457627118644,   noise_multiplier 3.42529296875,   no individual parameters
INFO:root:iteration: 0,   train accuracy: 10.14,   test accuracy: 10.09,   loss: 2.31262,   DP costs: 0.053,   average batch-size: 513,   best alpha: 111.95,   time: 1
INFO:root:iteration: 100,   train accuracy: 70.17,   test accuracy: 71.82,   loss: 1.17857,   DP costs: 0.092,   average batch-size: 505,   best alpha: 110.59,   time: 9
INFO:root:iteration: 200,   train accuracy: 79.53,   test accuracy: 80.44,   loss: 0.6155,   DP costs: 0.129,   average batch-size: 507,   best alpha: 97.04,   time: 18
INFO:root:iteration: 300,   train accuracy: 86.28,   test accuracy: 86.49,   loss: 0.4285,   DP costs: 0.16,   average batch-size: 509,   best alpha: 81.43,   time: 26
INFO:root:iteration: 400,   train accuracy: 88.56,   test accuracy: 89.74,   loss: 0.4011,   DP costs: 0.186,   average batch-size: 511,   best alpha: 72.07,   time: 33
INFO:root:iteration: 500,   train accuracy: 91.25,   test accuracy: 91.91,   loss: 0.09834,   DP costs: 0.209,   average batch-size: 516,   best alpha: 65.38,   time: 42
INFO:root:iteration: 600,   train accuracy: 92.36,   test accuracy: 93.0,   loss: 0.46379,   DP costs: 0.23,   average batch-size: 513,   best alpha: 60.28,   time: 50
INFO:root:iteration: 700,   train accuracy: 93.09,   test accuracy: 93.53,   loss: 0.22103,   DP costs: 0.249,   average batch-size: 506,   best alpha: 56.27,   time: 57
INFO:root:iteration: 800,   train accuracy: 92.96,   test accuracy: 94.05,   loss: 0.23285,   DP costs: 0.267,   average batch-size: 505,   best alpha: 53.17,   time: 65
INFO:root:iteration: 900,   train accuracy: 93.11,   test accuracy: 94.57,   loss: 0.32589,   DP costs: 0.284,   average batch-size: 511,   best alpha: 50.44,   time: 73
INFO:root:iteration: 1000,   train accuracy: 93.93,   test accuracy: 94.68,   loss: 0.27896,   DP costs: 0.301,   average batch-size: 494,   best alpha: 48.06,   time: 80
INFO:root:iteration: 1100,   train accuracy: 95.04,   test accuracy: 95.05,   loss: 0.11254,   DP costs: 0.316,   average batch-size: 506,   best alpha: 46.16,   time: 89
INFO:root:iteration: 1200,   train accuracy: 94.71,   test accuracy: 95.42,   loss: 0.33043,   DP costs: 0.331,   average batch-size: 502,   best alpha: 44.33,   time: 96
INFO:root:iteration: 1300,   train accuracy: 94.71,   test accuracy: 95.42,   loss: 0.27929,   DP costs: 0.346,   average batch-size: 506,   best alpha: 42.75,   time: 104
INFO:root:iteration: 1400,   train accuracy: 95.11,   test accuracy: 95.59,   loss: 0.25646,   DP costs: 0.36,   average batch-size: 504,   best alpha: 41.4,   time: 112
INFO:root:iteration: 1500,   train accuracy: 95.46,   test accuracy: 95.73,   loss: 0.22081,   DP costs: 0.373,   average batch-size: 523,   best alpha: 40.25,   time: 120
INFO:root:iteration: 1600,   train accuracy: 94.83,   test accuracy: 95.77,   loss: 0.27819,   DP costs: 0.386,   average batch-size: 501,   best alpha: 38.97,   time: 128
INFO:root:iteration: 1700,   train accuracy: 95.85,   test accuracy: 96.02,   loss: 0.25069,   DP costs: 0.399,   average batch-size: 508,   best alpha: 38.05,   time: 136
INFO:root:iteration: 1800,   train accuracy: 95.9,   test accuracy: 95.95,   loss: 0.2073,   DP costs: 0.411,   average batch-size: 511,   best alpha: 36.99,   time: 143
INFO:root:iteration: 1900,   train accuracy: 95.44,   test accuracy: 95.96,   loss: 0.18029,   DP costs: 0.423,   average batch-size: 501,   best alpha: 36.11,   time: 150
INFO:root:iteration: 2000,   train accuracy: 95.44,   test accuracy: 96.02,   loss: 0.12375,   DP costs: 0.435,   average batch-size: 496,   best alpha: 35.4,   time: 159
INFO:root:iteration: 2100,   train accuracy: 96.3,   test accuracy: 96.19,   loss: 0.32823,   DP costs: 0.446,   average batch-size: 512,   best alpha: 34.56,   time: 167
INFO:root:iteration: 2200,   train accuracy: 95.51,   test accuracy: 96.32,   loss: 0.12486,   DP costs: 0.457,   average batch-size: 515,   best alpha: 33.87,   time: 176
INFO:root:iteration: 2300,   train accuracy: 96.04,   test accuracy: 96.35,   loss: 0.12235,   DP costs: 0.468,   average batch-size: 507,   best alpha: 33.2,   time: 184
INFO:root:iteration: 2400,   train accuracy: 96.6,   test accuracy: 96.22,   loss: 0.12502,   DP costs: 0.479,   average batch-size: 503,   best alpha: 32.54,   time: 192
INFO:root:iteration: 2500,   train accuracy: 96.14,   test accuracy: 96.26,   loss: 0.01047,   DP costs: 0.49,   average batch-size: 515,   best alpha: 32.03,   time: 200
INFO:root:iteration: 2600,   train accuracy: 95.97,   test accuracy: 96.32,   loss: 0.24078,   DP costs: 0.5,   average batch-size: 514,   best alpha: 31.39,   time: 207
INFO:root:iteration: 2700,   train accuracy: 96.03,   test accuracy: 96.39,   loss: 0.25295,   DP costs: 0.51,   average batch-size: 513,   best alpha: 30.9,   time: 215
INFO:root:iteration: 2800,   train accuracy: 96.16,   test accuracy: 96.41,   loss: 0.117,   DP costs: 0.52,   average batch-size: 515,   best alpha: 30.41,   time: 222
INFO:root:iteration: 2900,   train accuracy: 96.67,   test accuracy: 96.46,   loss: 0.12713,   DP costs: 0.53,   average batch-size: 503,   best alpha: 29.93,   time: 231
INFO:root:iteration: 3000,   train accuracy: 95.98,   test accuracy: 96.54,   loss: 0.10706,   DP costs: 0.54,   average batch-size: 498,   best alpha: 29.45,   time: 238
INFO:root:iteration: 3100,   train accuracy: 96.61,   test accuracy: 96.58,   loss: 0.02581,   DP costs: 0.549,   average batch-size: 524,   best alpha: 29.1,   time: 245
INFO:root:iteration: 3200,   train accuracy: 96.43,   test accuracy: 96.55,   loss: 0.05738,   DP costs: 0.559,   average batch-size: 497,   best alpha: 28.64,   time: 253
INFO:root:iteration: 3300,   train accuracy: 96.23,   test accuracy: 96.64,   loss: 0.13803,   DP costs: 0.568,   average batch-size: 510,   best alpha: 28.3,   time: 261
INFO:root:iteration: 3400,   train accuracy: 96.18,   test accuracy: 96.69,   loss: 0.25919,   DP costs: 0.577,   average batch-size: 499,   best alpha: 27.86,   time: 268
INFO:root:iteration: 3500,   train accuracy: 96.61,   test accuracy: 96.7,   loss: 0.07889,   DP costs: 0.586,   average batch-size: 521,   best alpha: 27.53,   time: 276
INFO:root:iteration: 3600,   train accuracy: 95.87,   test accuracy: 96.61,   loss: 0.12986,   DP costs: 0.595,   average batch-size: 503,   best alpha: 27.2,   time: 283
INFO:root:iteration: 3700,   train accuracy: 96.51,   test accuracy: 96.81,   loss: 0.1663,   DP costs: 0.604,   average batch-size: 513,   best alpha: 26.88,   time: 291
INFO:root:iteration: 3800,   train accuracy: 96.94,   test accuracy: 96.75,   loss: 0.15954,   DP costs: 0.613,   average batch-size: 522,   best alpha: 26.56,   time: 299
INFO:root:iteration: 3900,   train accuracy: 97.15,   test accuracy: 96.91,   loss: 0.06913,   DP costs: 0.621,   average batch-size: 507,   best alpha: 26.25,   time: 307
INFO:root:iteration: 4000,   train accuracy: 96.02,   test accuracy: 96.88,   loss: 0.03648,   DP costs: 0.63,   average batch-size: 509,   best alpha: 25.94,   time: 314
INFO:root:iteration: 4100,   train accuracy: 97.17,   test accuracy: 96.88,   loss: 0.07796,   DP costs: 0.638,   average batch-size: 509,   best alpha: 25.63,   time: 321
INFO:root:iteration: 4200,   train accuracy: 96.08,   test accuracy: 96.9,   loss: 0.19865,   DP costs: 0.646,   average batch-size: 506,   best alpha: 25.43,   time: 329
INFO:root:iteration: 4300,   train accuracy: 96.75,   test accuracy: 96.99,   loss: 0.04452,   DP costs: 0.655,   average batch-size: 503,   best alpha: 25.13,   time: 337
INFO:root:iteration: 4400,   train accuracy: 96.37,   test accuracy: 96.97,   loss: 0.07153,   DP costs: 0.663,   average batch-size: 511,   best alpha: 24.83,   time: 344
INFO:root:iteration: 4500,   train accuracy: 96.46,   test accuracy: 96.81,   loss: 0.08676,   DP costs: 0.671,   average batch-size: 495,   best alpha: 24.63,   time: 352
INFO:root:iteration: 4600,   train accuracy: 97.06,   test accuracy: 96.83,   loss: 0.08404,   DP costs: 0.679,   average batch-size: 505,   best alpha: 24.34,   time: 361
INFO:root:iteration: 4700,   train accuracy: 96.16,   test accuracy: 96.8,   loss: 0.13946,   DP costs: 0.687,   average batch-size: 505,   best alpha: 24.15,   time: 370
INFO:root:iteration: 4800,   train accuracy: 96.29,   test accuracy: 96.88,   loss: 0.15776,   DP costs: 0.694,   average batch-size: 505,   best alpha: 23.96,   time: 378
INFO:root:iteration: 4900,   train accuracy: 97.18,   test accuracy: 96.88,   loss: 0.39503,   DP costs: 0.702,   average batch-size: 499,   best alpha: 23.68,   time: 386
INFO:root:iteration: 5000,   train accuracy: 96.81,   test accuracy: 96.81,   loss: 0.17607,   DP costs: 0.71,   average batch-size: 513,   best alpha: 23.49,   time: 395
INFO:root:iteration: 5100,   train accuracy: 96.15,   test accuracy: 96.81,   loss: 0.09658,   DP costs: 0.717,   average batch-size: 500,   best alpha: 23.31,   time: 403
INFO:root:iteration: 5200,   train accuracy: 96.82,   test accuracy: 96.9,   loss: 0.0752,   DP costs: 0.725,   average batch-size: 509,   best alpha: 23.13,   time: 411
INFO:root:iteration: 5300,   train accuracy: 96.59,   test accuracy: 96.79,   loss: 0.11693,   DP costs: 0.732,   average batch-size: 511,   best alpha: 22.85,   time: 418
INFO:root:iteration: 5400,   train accuracy: 96.65,   test accuracy: 96.86,   loss: 0.18304,   DP costs: 0.74,   average batch-size: 513,   best alpha: 22.67,   time: 427
INFO:root:iteration: 5500,   train accuracy: 96.53,   test accuracy: 96.87,   loss: 0.11377,   DP costs: 0.747,   average batch-size: 507,   best alpha: 22.5,   time: 436
INFO:root:iteration: 5600,   train accuracy: 96.74,   test accuracy: 97.0,   loss: 0.21398,   DP costs: 0.754,   average batch-size: 513,   best alpha: 22.32,   time: 444
INFO:root:iteration: 5700,   train accuracy: 97.83,   test accuracy: 96.87,   loss: 0.10409,   DP costs: 0.762,   average batch-size: 513,   best alpha: 22.14,   time: 453
INFO:root:iteration: 5800,   train accuracy: 95.75,   test accuracy: 96.97,   loss: 0.09317,   DP costs: 0.769,   average batch-size: 510,   best alpha: 21.97,   time: 461
INFO:root:iteration: 5900,   train accuracy: 96.88,   test accuracy: 96.96,   loss: 0.13861,   DP costs: 0.776,   average batch-size: 517,   best alpha: 21.8,   time: 471
INFO:root:iteration: 6000,   train accuracy: 96.43,   test accuracy: 96.97,   loss: 0.09565,   DP costs: 0.783,   average batch-size: 509,   best alpha: 21.63,   time: 478
INFO:root:iteration: 6100,   train accuracy: 96.07,   test accuracy: 97.03,   loss: 0.15318,   DP costs: 0.79,   average batch-size: 496,   best alpha: 21.54,   time: 486
INFO:root:iteration: 6200,   train accuracy: 97.11,   test accuracy: 97.0,   loss: 0.0801,   DP costs: 0.797,   average batch-size: 518,   best alpha: 21.37,   time: 494
INFO:root:iteration: 6300,   train accuracy: 96.31,   test accuracy: 96.85,   loss: 0.32159,   DP costs: 0.804,   average batch-size: 510,   best alpha: 21.21,   time: 500
INFO:root:iteration: 6400,   train accuracy: 97.0,   test accuracy: 96.92,   loss: 0.12134,   DP costs: 0.81,   average batch-size: 521,   best alpha: 21.04,   time: 508
INFO:root:iteration: 6500,   train accuracy: 96.51,   test accuracy: 96.89,   loss: 0.08439,   DP costs: 0.817,   average batch-size: 518,   best alpha: 20.88,   time: 515
INFO:root:iteration: 6600,   train accuracy: 96.66,   test accuracy: 97.03,   loss: 0.24178,   DP costs: 0.824,   average batch-size: 509,   best alpha: 20.79,   time: 523
INFO:root:iteration: 6700,   train accuracy: 96.69,   test accuracy: 96.93,   loss: 0.15701,   DP costs: 0.831,   average batch-size: 512,   best alpha: 20.63,   time: 530
INFO:root:iteration: 6800,   train accuracy: 97.23,   test accuracy: 97.0,   loss: 0.02082,   DP costs: 0.837,   average batch-size: 503,   best alpha: 20.47,   time: 538
INFO:root:iteration: 6900,   train accuracy: 96.53,   test accuracy: 96.97,   loss: 0.14262,   DP costs: 0.844,   average batch-size: 501,   best alpha: 20.39,   time: 546
INFO:root:iteration: 7000,   train accuracy: 96.71,   test accuracy: 96.94,   loss: 0.24346,   DP costs: 0.851,   average batch-size: 513,   best alpha: 20.23,   time: 555
INFO:root:iteration: 7100,   train accuracy: 97.29,   test accuracy: 96.94,   loss: 0.07927,   DP costs: 0.857,   average batch-size: 514,   best alpha: 20.07,   time: 564
INFO:root:iteration: 7200,   train accuracy: 96.7,   test accuracy: 97.06,   loss: 0.05018,   DP costs: 0.864,   average batch-size: 515,   best alpha: 19.99,   time: 571
INFO:root:iteration: 7300,   train accuracy: 97.14,   test accuracy: 97.02,   loss: 0.05612,   DP costs: 0.87,   average batch-size: 505,   best alpha: 19.84,   time: 579
INFO:root:iteration: 7400,   train accuracy: 96.49,   test accuracy: 96.91,   loss: 0.12986,   DP costs: 0.876,   average batch-size: 507,   best alpha: 19.76,   time: 588
INFO:root:iteration: 7500,   train accuracy: 96.48,   test accuracy: 96.86,   loss: 0.01172,   DP costs: 0.883,   average batch-size: 503,   best alpha: 19.61,   time: 595
INFO:root:iteration: 7600,   train accuracy: 96.55,   test accuracy: 96.95,   loss: 0.15836,   DP costs: 0.889,   average batch-size: 498,   best alpha: 19.53,   time: 603
INFO:root:iteration: 7700,   train accuracy: 96.72,   test accuracy: 96.88,   loss: 0.21923,   DP costs: 0.895,   average batch-size: 520,   best alpha: 19.38,   time: 610
INFO:root:iteration: 7800,   train accuracy: 97.0,   test accuracy: 96.87,   loss: 0.27273,   DP costs: 0.902,   average batch-size: 506,   best alpha: 19.3,   time: 619
INFO:root:iteration: 7900,   train accuracy: 96.84,   test accuracy: 96.91,   loss: 0.10055,   DP costs: 0.908,   average batch-size: 505,   best alpha: 19.15,   time: 625
INFO:root:iteration: 8000,   train accuracy: 96.99,   test accuracy: 96.85,   loss: 0.22555,   DP costs: 0.914,   average batch-size: 504,   best alpha: 19.08,   time: 634
INFO:root:iteration: 8100,   train accuracy: 96.91,   test accuracy: 96.8,   loss: 0.02865,   DP costs: 0.92,   average batch-size: 511,   best alpha: 18.93,   time: 642
INFO:root:iteration: 8200,   train accuracy: 96.25,   test accuracy: 96.8,   loss: 0.21237,   DP costs: 0.926,   average batch-size: 503,   best alpha: 18.85,   time: 650
INFO:root:iteration: 8300,   train accuracy: 96.78,   test accuracy: 96.89,   loss: 0.09207,   DP costs: 0.932,   average batch-size: 509,   best alpha: 18.78,   time: 658
INFO:root:iteration: 8400,   train accuracy: 97.01,   test accuracy: 96.85,   loss: 0.07747,   DP costs: 0.938,   average batch-size: 512,   best alpha: 18.64,   time: 666
INFO:root:iteration: 8500,   train accuracy: 96.59,   test accuracy: 96.85,   loss: 0.01833,   DP costs: 0.945,   average batch-size: 525,   best alpha: 18.56,   time: 673
INFO:root:iteration: 8600,   train accuracy: 96.81,   test accuracy: 96.77,   loss: 0.04761,   DP costs: 0.951,   average batch-size: 515,   best alpha: 18.49,   time: 681
INFO:root:iteration: 8700,   train accuracy: 96.03,   test accuracy: 96.94,   loss: 0.16796,   DP costs: 0.956,   average batch-size: 507,   best alpha: 18.35,   time: 689
INFO:root:iteration: 8800,   train accuracy: 97.38,   test accuracy: 96.96,   loss: 0.11968,   DP costs: 0.962,   average batch-size: 505,   best alpha: 18.28,   time: 697
INFO:root:iteration: 8900,   train accuracy: 97.12,   test accuracy: 96.95,   loss: 0.104,   DP costs: 0.968,   average batch-size: 507,   best alpha: 18.2,   time: 705
INFO:root:iteration: 9000,   train accuracy: 96.81,   test accuracy: 96.92,   loss: 0.16564,   DP costs: 0.974,   average batch-size: 499,   best alpha: 18.13,   time: 711
INFO:root:iteration: 9100,   train accuracy: 96.57,   test accuracy: 97.01,   loss: 0.22437,   DP costs: 0.98,   average batch-size: 511,   best alpha: 17.99,   time: 720
INFO:root:iteration: 9200,   train accuracy: 96.84,   test accuracy: 97.02,   loss: 0.14121,   DP costs: 0.986,   average batch-size: 511,   best alpha: 17.92,   time: 727
INFO:root:iteration: 9300,   train accuracy: 97.17,   test accuracy: 96.95,   loss: 0.27923,   DP costs: 0.992,   average batch-size: 504,   best alpha: 17.85,   time: 735
INFO:root:iteration: 9374,   train accuracy: 96.38,   test accuracy: 97.04,   loss: 0.22281,   DP costs: 0.996,   average batch-size: 522,   best alpha: 17.78,   time: 742
INFO:root:Terminate: The maximum of iterations is reached!
