INFO:root:Input args: Namespace(dname='CIFAR10', seeds=[0], architecture='CIFAR10_CNN', accountant='rdp', individualize='clipping', log_iteration=100, lr=0.2, momentum=0.5, epochs=70, n_workers=6, batch_size=1024, max_physical_batch_size=128, delta=1e-05, budgets=[1.0, 2.0, 3.0], ratios=[0.34, 0.43, 0.23], max_grad_norm=1.1, noise_multiplier=2.88335, weights=None, adapt_weights_to_budgets=True, use_cuda='True', save_path='../cifar_results/clipping/CIFAR10/epochs_70_batch_1024_lr_0.2_max_grad_norm_1.1_budgets_1.0_2.0_3.0_ratios_0.34_0.43_0.23_seeds_0', mode='mia', accuracy_log='accuracy.log', assign_budget='random', class_budgets=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], mia_ndata=50000, mia_count=0, allow_excess=False, save_model='True')
INFO:root:seed: 0,   max_iteration: 3418,   1 epoch ~= 49 iterations
INFO:root:seed: 0,   max_iteration: 3418,   1 epoch ~= 49 iterations
INFO:root:Initializing privacy parameters:   max_grad_norm=1.1,   sample_rate=0.02040816326530612,   noise_multiplier 3.2799560546875,   individual max_grad_norms=[0.733044146825397, 1.338602355072464, 1.8542245922208282]
INFO:root:iteration: 0,   train accuracy: 10.22,   test accuracy: 10.35,   loss: 2.30016,   DP costs: [0.03, 0.12, 0.254],   average batch-size: 942,   best alpha: [187.04, 56.35, 29.67],   time: 1
INFO:root:iteration: 100,   train accuracy: 30.19,   test accuracy: 31.06,   loss: 1.99487,   DP costs: [0.154, 0.315, 0.487],   average batch-size: 1030,   best alpha: [83.75, 43.86, 27.73],   time: 32
INFO:root:iteration: 200,   train accuracy: 36.72,   test accuracy: 37.99,   loss: 1.80726,   DP costs: [0.22, 0.446, 0.678],   average batch-size: 1022,   best alpha: [62.24, 33.24, 22.66],   time: 61
INFO:root:iteration: 300,   train accuracy: 41.15,   test accuracy: 41.85,   loss: 1.85117,   DP costs: [0.272, 0.549, 0.83],   average batch-size: 1014,   best alpha: [52.07, 28.11, 19.44],   time: 91
INFO:root:iteration: 400,   train accuracy: 42.73,   test accuracy: 43.08,   loss: 1.84613,   DP costs: [0.317, 0.637, 0.96],   average batch-size: 1023,   best alpha: [45.95, 24.96, 17.36],   time: 120
INFO:root:iteration: 500,   train accuracy: 45.7,   test accuracy: 45.43,   loss: 1.60422,   DP costs: [0.357, 0.716, 1.077],   average batch-size: 1018,   best alpha: [41.71, 22.7, 15.94],   time: 149
INFO:root:iteration: 600,   train accuracy: 47.08,   test accuracy: 46.97,   loss: 1.54559,   DP costs: [0.393, 0.787, 1.183],   average batch-size: 1026,   best alpha: [38.33, 21.07, 14.82],   time: 179
INFO:root:iteration: 700,   train accuracy: 48.72,   test accuracy: 48.57,   loss: 1.30829,   DP costs: [0.427, 0.854, 1.282],   average batch-size: 1010,   best alpha: [35.81, 19.71, 13.93],   time: 208
INFO:root:iteration: 800,   train accuracy: 49.51,   test accuracy: 49.84,   loss: 1.45655,   DP costs: [0.458, 0.916, 1.374],   average batch-size: 1016,   best alpha: [33.85, 18.66, 13.21],   time: 237
INFO:root:iteration: 900,   train accuracy: 50.6,   test accuracy: 50.32,   loss: 1.40521,   DP costs: [0.488, 0.975, 1.462],   average batch-size: 1025,   best alpha: [32.14, 17.74, 12.57],   time: 266
INFO:root:iteration: 1000,   train accuracy: 51.56,   test accuracy: 51.38,   loss: 1.57966,   DP costs: [0.516, 1.031, 1.545],   average batch-size: 1021,   best alpha: [30.63, 16.99, 12.06],   time: 295
INFO:root:iteration: 1100,   train accuracy: 52.46,   test accuracy: 52.71,   loss: 1.61784,   DP costs: [0.543, 1.084, 1.625],   average batch-size: 1010,   best alpha: [29.32, 16.28, 11.61],   time: 324
INFO:root:iteration: 1200,   train accuracy: 54.08,   test accuracy: 54.0,   loss: 1.44028,   DP costs: [0.568, 1.136, 1.701],   average batch-size: 1029,   best alpha: [28.18, 15.73, 11.23],   time: 353
INFO:root:iteration: 1300,   train accuracy: 55.18,   test accuracy: 54.35,   loss: 1.28069,   DP costs: [0.593, 1.185, 1.775],   average batch-size: 1014,   best alpha: [27.19, 15.19, 10.85],   time: 382
INFO:root:iteration: 1400,   train accuracy: 54.38,   test accuracy: 54.16,   loss: 1.35092,   DP costs: [0.617, 1.233, 1.847],   average batch-size: 1012,   best alpha: [26.34, 14.73, 10.53],   time: 411
INFO:root:iteration: 1500,   train accuracy: 55.07,   test accuracy: 54.9,   loss: 1.22408,   DP costs: [0.641, 1.279, 1.916],   average batch-size: 1025,   best alpha: [25.51, 14.29, 10.26],   time: 441
INFO:root:iteration: 1600,   train accuracy: 56.49,   test accuracy: 56.13,   loss: 1.43619,   DP costs: [0.663, 1.324, 1.983],   average batch-size: 1004,   best alpha: [24.82, 13.91, 10.0],   time: 469
INFO:root:iteration: 1700,   train accuracy: 57.28,   test accuracy: 56.37,   loss: 1.30414,   DP costs: [0.685, 1.368, 2.049],   average batch-size: 1024,   best alpha: [24.14, 13.54, 9.74],   time: 499
INFO:root:iteration: 1800,   train accuracy: 56.58,   test accuracy: 56.2,   loss: 1.25315,   DP costs: [0.706, 1.411, 2.113],   average batch-size: 1043,   best alpha: [23.57, 13.23, 9.53],   time: 528
INFO:root:iteration: 1900,   train accuracy: 57.24,   test accuracy: 56.17,   loss: 1.53672,   DP costs: [0.727, 1.452, 2.175],   average batch-size: 1028,   best alpha: [23.02, 12.93, 9.32],   time: 558
INFO:root:iteration: 2000,   train accuracy: 57.46,   test accuracy: 56.55,   loss: 1.27266,   DP costs: [0.747, 1.493, 2.236],   average batch-size: 1023,   best alpha: [22.48, 12.64, 9.12],   time: 587
INFO:root:iteration: 2100,   train accuracy: 57.3,   test accuracy: 56.45,   loss: 1.73351,   DP costs: [0.767, 1.532, 2.296],   average batch-size: 1030,   best alpha: [22.05, 12.41, 8.95],   time: 616
INFO:root:iteration: 2200,   train accuracy: 57.56,   test accuracy: 56.77,   loss: 1.28471,   DP costs: [0.787, 1.571, 2.354],   average batch-size: 994,   best alpha: [21.53, 12.17, 8.79],   time: 645
INFO:root:iteration: 2300,   train accuracy: 57.64,   test accuracy: 56.78,   loss: 1.45052,   DP costs: [0.806, 1.61, 2.412],   average batch-size: 1025,   best alpha: [21.11, 11.94, 8.63],   time: 674
INFO:root:iteration: 2400,   train accuracy: 58.34,   test accuracy: 57.09,   loss: 1.31636,   DP costs: [0.824, 1.647, 2.468],   average batch-size: 1025,   best alpha: [20.78, 11.72, 8.47],   time: 703
INFO:root:iteration: 2500,   train accuracy: 57.93,   test accuracy: 57.89,   loss: 1.25245,   DP costs: [0.843, 1.684, 2.523],   average batch-size: 1009,   best alpha: [20.38, 11.5, 8.35],   time: 733
INFO:root:iteration: 2600,   train accuracy: 58.79,   test accuracy: 57.43,   loss: 1.36247,   DP costs: [0.861, 1.72, 2.578],   average batch-size: 1018,   best alpha: [19.98, 11.33, 8.23],   time: 762
INFO:root:iteration: 2700,   train accuracy: 59.26,   test accuracy: 57.94,   loss: 1.18579,   DP costs: [0.878, 1.755, 2.631],   average batch-size: 1015,   best alpha: [19.67, 11.16, 8.08],   time: 791
INFO:root:iteration: 2800,   train accuracy: 58.72,   test accuracy: 57.86,   loss: 1.4032,   DP costs: [0.896, 1.79, 2.684],   average batch-size: 1008,   best alpha: [19.37, 11.0, 7.97],   time: 820
INFO:root:iteration: 2900,   train accuracy: 58.79,   test accuracy: 57.97,   loss: 1.24439,   DP costs: [0.913, 1.825, 2.736],   average batch-size: 1006,   best alpha: [19.07, 10.83, 7.88],   time: 848
INFO:root:iteration: 3000,   train accuracy: 59.27,   test accuracy: 58.12,   loss: 1.33027,   DP costs: [0.93, 1.859, 2.787],   average batch-size: 1034,   best alpha: [18.77, 10.67, 7.77],   time: 878
INFO:root:iteration: 3100,   train accuracy: 59.4,   test accuracy: 57.73,   loss: 1.33474,   DP costs: [0.946, 1.892, 2.837],   average batch-size: 1009,   best alpha: [18.55, 10.51, 7.66],   time: 907
INFO:root:iteration: 3200,   train accuracy: 59.8,   test accuracy: 58.26,   loss: 1.10807,   DP costs: [0.963, 1.925, 2.887],   average batch-size: 1024,   best alpha: [18.27, 10.4, 7.58],   time: 936
INFO:root:iteration: 3300,   train accuracy: 59.8,   test accuracy: 57.54,   loss: 1.4456,   DP costs: [0.979, 1.958, 2.936],   average batch-size: 1037,   best alpha: [17.98, 10.24, 7.47],   time: 966
INFO:root:iteration: 3400,   train accuracy: 58.86,   test accuracy: 58.11,   loss: 1.59918,   DP costs: [0.995, 1.99, 2.985],   average batch-size: 1015,   best alpha: [17.77, 10.13, 7.39],   time: 995
INFO:root:iteration: 3417,   train accuracy: 59.01,   test accuracy: 58.5,   loss: 0.93238,   DP costs: [0.997, 1.995, 2.993],   average batch-size: 997,   best alpha: [17.77, 10.09, 7.36],   time: 1003
INFO:root:Terminate: The maximum of iterations is reached!
