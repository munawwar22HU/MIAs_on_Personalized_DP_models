INFO:root:Input args: Namespace(dname='CIFAR10', seeds=[0], architecture='CIFAR10_CNN', accountant='rdp', individualize='clipping', log_iteration=100, lr=0.1, momentum=0.5, epochs=60, n_workers=6, batch_size=1024, max_physical_batch_size=128, delta=1e-05, budgets=[1.0, 2.0, 3.0], ratios=[0.54, 0.37, 0.09], max_grad_norm=1.8, noise_multiplier=3.17792, weights=None, adapt_weights_to_budgets=True, use_cuda='True', save_path='../cifar_results/clipping/CIFAR10/epochs_60_batch_1024_lr_0.1_max_grad_norm_1.8_budgets_1.0_2.0_3.0_ratios_0.54_0.37_0.09_seeds_0', mode='mia', accuracy_log='accuracy.log', assign_budget='random', class_budgets=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], mia_ndata=50000, mia_count=0, allow_excess=False, save_model='True')
INFO:root:seed: 0,   max_iteration: 2930,   1 epoch ~= 49 iterations
INFO:root:seed: 0,   max_iteration: 2930,   1 epoch ~= 49 iterations
INFO:root:Initializing privacy parameters:   max_grad_norm=1.8,   sample_rate=0.02040816326530612,   noise_multiplier 3.5613159179687504,   individual max_grad_norms=[1.4033602351683592, 2.549210679611651, 3.51262474916388]
INFO:root:iteration: 0,   train accuracy: 10.3,   test accuracy: 10.24,   loss: 2.30016,   DP costs: [0.036, 0.141, 0.295],   average batch-size: 942,   best alpha: [161.29, 49.13, 26.2],   time: 1
INFO:root:iteration: 100,   train accuracy: 28.52,   test accuracy: 29.1,   loss: 2.03599,   DP costs: [0.167, 0.344, 0.538],   average batch-size: 1030,   best alpha: [77.58, 40.32, 24.38],   time: 32
INFO:root:iteration: 200,   train accuracy: 34.12,   test accuracy: 35.63,   loss: 1.87141,   DP costs: [0.24, 0.486, 0.741],   average batch-size: 1022,   best alpha: [57.9, 30.83, 20.91],   time: 62
INFO:root:iteration: 300,   train accuracy: 39.17,   test accuracy: 39.54,   loss: 1.90899,   DP costs: [0.296, 0.598, 0.906],   average batch-size: 1014,   best alpha: [48.46, 26.08, 17.95],   time: 91
INFO:root:iteration: 400,   train accuracy: 41.19,   test accuracy: 41.33,   loss: 1.84268,   DP costs: [0.345, 0.693, 1.047],   average batch-size: 1023,   best alpha: [42.77, 23.16, 16.1],   time: 121
INFO:root:iteration: 500,   train accuracy: 43.8,   test accuracy: 44.1,   loss: 1.60531,   DP costs: [0.388, 0.778, 1.173],   average batch-size: 1018,   best alpha: [38.68, 21.16, 14.79],   time: 150
INFO:root:iteration: 600,   train accuracy: 45.02,   test accuracy: 45.38,   loss: 1.55445,   DP costs: [0.427, 0.856, 1.288],   average batch-size: 1026,   best alpha: [35.69, 19.56, 13.75],   time: 180
INFO:root:iteration: 700,   train accuracy: 46.74,   test accuracy: 46.5,   loss: 1.34243,   DP costs: [0.464, 0.928, 1.395],   average batch-size: 1010,   best alpha: [33.34, 18.38, 12.94],   time: 209
INFO:root:iteration: 800,   train accuracy: 47.72,   test accuracy: 47.72,   loss: 1.45465,   DP costs: [0.498, 0.996, 1.495],   average batch-size: 1016,   best alpha: [31.4, 17.33, 12.27],   time: 238
INFO:root:iteration: 900,   train accuracy: 48.79,   test accuracy: 48.65,   loss: 1.44245,   DP costs: [0.53, 1.06, 1.591],   average batch-size: 1025,   best alpha: [29.82, 16.55, 11.72],   time: 267
INFO:root:iteration: 1000,   train accuracy: 49.62,   test accuracy: 49.5,   loss: 1.55696,   DP costs: [0.561, 1.12, 1.681],   average batch-size: 1021,   best alpha: [28.54, 15.8, 11.25],   time: 296
INFO:root:iteration: 1100,   train accuracy: 50.42,   test accuracy: 50.87,   loss: 1.59909,   DP costs: [0.59, 1.179, 1.768],   average batch-size: 1010,   best alpha: [27.32, 15.2, 10.83],   time: 325
INFO:root:iteration: 1200,   train accuracy: 52.11,   test accuracy: 51.69,   loss: 1.44589,   DP costs: [0.618, 1.234, 1.851],   average batch-size: 1029,   best alpha: [26.25, 14.62, 10.48],   time: 354
INFO:root:iteration: 1300,   train accuracy: 53.26,   test accuracy: 52.37,   loss: 1.30458,   DP costs: [0.645, 1.288, 1.931],   average batch-size: 1014,   best alpha: [25.33, 14.18, 10.13],   time: 383
INFO:root:iteration: 1400,   train accuracy: 52.25,   test accuracy: 52.51,   loss: 1.31652,   DP costs: [0.671, 1.34, 2.009],   average batch-size: 1012,   best alpha: [24.54, 13.7, 9.83],   time: 412
INFO:root:iteration: 1500,   train accuracy: 52.72,   test accuracy: 52.65,   loss: 1.27364,   DP costs: [0.696, 1.39, 2.084],   average batch-size: 1025,   best alpha: [23.78, 13.34, 9.58],   time: 441
INFO:root:iteration: 1600,   train accuracy: 54.9,   test accuracy: 54.26,   loss: 1.41935,   DP costs: [0.721, 1.439, 2.157],   average batch-size: 1004,   best alpha: [23.13, 12.99, 9.34],   time: 470
INFO:root:iteration: 1700,   train accuracy: 55.74,   test accuracy: 55.22,   loss: 1.28317,   DP costs: [0.745, 1.487, 2.229],   average batch-size: 1024,   best alpha: [22.5, 12.65, 9.1],   time: 499
INFO:root:iteration: 1800,   train accuracy: 55.36,   test accuracy: 54.94,   loss: 1.26919,   DP costs: [0.768, 1.533, 2.298],   average batch-size: 1043,   best alpha: [21.98, 12.36, 8.9],   time: 528
INFO:root:iteration: 1900,   train accuracy: 56.29,   test accuracy: 55.31,   loss: 1.50359,   DP costs: [0.79, 1.578, 2.366],   average batch-size: 1028,   best alpha: [21.46, 12.09, 8.71],   time: 558
INFO:root:iteration: 2000,   train accuracy: 55.93,   test accuracy: 55.74,   loss: 1.29238,   DP costs: [0.813, 1.623, 2.432],   average batch-size: 1023,   best alpha: [20.96, 11.82, 8.55],   time: 587
INFO:root:iteration: 2100,   train accuracy: 56.19,   test accuracy: 56.21,   loss: 1.66605,   DP costs: [0.834, 1.666, 2.497],   average batch-size: 1030,   best alpha: [20.48, 11.59, 8.37],   time: 616
INFO:root:iteration: 2200,   train accuracy: 56.74,   test accuracy: 56.49,   loss: 1.31581,   DP costs: [0.855, 1.708, 2.561],   average batch-size: 994,   best alpha: [20.08, 11.38, 8.22],   time: 645
INFO:root:iteration: 2300,   train accuracy: 56.99,   test accuracy: 55.85,   loss: 1.35295,   DP costs: [0.876, 1.75, 2.623],   average batch-size: 1025,   best alpha: [19.69, 11.17, 8.07],   time: 674
INFO:root:iteration: 2400,   train accuracy: 57.32,   test accuracy: 56.57,   loss: 1.27218,   DP costs: [0.896, 1.79, 2.685],   average batch-size: 1025,   best alpha: [19.31, 10.96, 7.96],   time: 703
INFO:root:iteration: 2500,   train accuracy: 57.46,   test accuracy: 57.4,   loss: 1.26865,   DP costs: [0.916, 1.83, 2.745],   average batch-size: 1009,   best alpha: [19.01, 10.76, 7.81],   time: 732
INFO:root:iteration: 2600,   train accuracy: 58.26,   test accuracy: 57.27,   loss: 1.27907,   DP costs: [0.936, 1.87, 2.804],   average batch-size: 1018,   best alpha: [18.64, 10.6, 7.7],   time: 761
INFO:root:iteration: 2700,   train accuracy: 58.28,   test accuracy: 57.21,   loss: 1.09473,   DP costs: [0.955, 1.908, 2.862],   average batch-size: 1015,   best alpha: [18.35, 10.44, 7.59],   time: 791
INFO:root:iteration: 2800,   train accuracy: 57.83,   test accuracy: 56.86,   loss: 1.39109,   DP costs: [0.974, 1.947, 2.92],   average batch-size: 1008,   best alpha: [18.07, 10.28, 7.48],   time: 820
INFO:root:iteration: 2900,   train accuracy: 58.24,   test accuracy: 57.38,   loss: 1.24898,   DP costs: [0.992, 1.984, 2.976],   average batch-size: 1006,   best alpha: [17.79, 10.13, 7.38],   time: 849
INFO:root:iteration: 2929,   train accuracy: 58.84,   test accuracy: 57.97,   loss: 1.34078,   DP costs: [0.998, 1.995, 2.992],   average batch-size: 1024,   best alpha: [17.72, 10.1, 7.35],   time: 861
INFO:root:Terminate: The maximum of iterations is reached!
