INFO:root:Input args: Namespace(dname='CIFAR10', seeds=[0], architecture='CIFAR10_CNN', accountant='rdp', individualize='sampling', log_iteration=100, lr=0.2, momentum=0.5, epochs=60, n_workers=6, batch_size=1024, max_physical_batch_size=128, delta=1e-05, budgets=[1.0, 2.0, 3.0], ratios=[0.34, 0.43, 0.23], max_grad_norm=1.0, noise_multiplier=2.65712, weights=None, adapt_weights_to_budgets=True, use_cuda='True', save_path='../cifar_results/sampling/CIFAR10/epochs_60_batch_1024_lr_0.2_max_grad_norm_1.0_budgets_1.0_2.0_3.0_ratios_0.34_0.43_0.23_seeds_0', mode='mia', accuracy_log='accuracy.log', assign_budget='random', class_budgets=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], mia_ndata=50000, mia_count=0, allow_excess=False, save_model='True')
INFO:root:seed: 0,   max_iteration: 2930,   1 epoch ~= 49 iterations
INFO:root:seed: 0,   max_iteration: 2930,   1 epoch ~= 49 iterations
INFO:root:Initializing privacy parameters:   max_grad_norm=1.0,   sample_rate=0.02040816326530612,   noise_multiplier 2.6571171875,   individual sample_rates=[0.01150512783807373, 0.021667481252075196, 0.031201172562988284]
INFO:root:iteration: 0,   train accuracy: 10.33,   test accuracy: 10.32,   loss: 2.3059,   DP costs: [0.104, 0.127, 0.146],   average batch-size: 947,   best alpha: [63.06, 53.86, 48.52],   time: 2
INFO:root:iteration: 100,   train accuracy: 28.6,   test accuracy: 29.11,   loss: 1.98097,   DP costs: [0.176, 0.342, 0.507],   average batch-size: 1033,   best alpha: [61.79, 40.76, 29.14],   time: 31
INFO:root:iteration: 200,   train accuracy: 34.07,   test accuracy: 35.38,   loss: 1.92291,   DP costs: [0.244, 0.484, 0.719],   average batch-size: 1021,   best alpha: [55.61, 30.92, 22.26],   time: 59
INFO:root:iteration: 300,   train accuracy: 38.39,   test accuracy: 39.37,   loss: 1.88928,   DP costs: [0.301, 0.596, 0.885],   average batch-size: 1016,   best alpha: [46.93, 26.26, 18.88],   time: 87
INFO:root:iteration: 400,   train accuracy: 40.24,   test accuracy: 41.21,   loss: 1.59182,   DP costs: [0.349, 0.692, 1.027],   average batch-size: 1023,   best alpha: [41.58, 23.32, 16.8],   time: 115
INFO:root:iteration: 500,   train accuracy: 42.65,   test accuracy: 43.48,   loss: 1.75742,   DP costs: [0.392, 0.777, 1.154],   average batch-size: 1024,   best alpha: [37.76, 21.22, 15.31],   time: 142
INFO:root:iteration: 600,   train accuracy: 44.31,   test accuracy: 44.9,   loss: 1.77819,   DP costs: [0.431, 0.855, 1.271],   average batch-size: 1038,   best alpha: [34.99, 19.7, 14.18],   time: 171
INFO:root:iteration: 700,   train accuracy: 45.72,   test accuracy: 45.91,   loss: 1.75982,   DP costs: [0.467, 0.927, 1.379],   average batch-size: 1012,   best alpha: [32.69, 18.43, 13.33],   time: 198
INFO:root:iteration: 800,   train accuracy: 46.71,   test accuracy: 46.84,   loss: 1.4971,   DP costs: [0.501, 0.995, 1.48],   average batch-size: 1002,   best alpha: [30.91, 17.38, 12.59],   time: 225
INFO:root:iteration: 900,   train accuracy: 47.96,   test accuracy: 48.1,   loss: 1.45757,   DP costs: [0.533, 1.058, 1.576],   average batch-size: 1021,   best alpha: [29.35, 16.59, 11.99],   time: 253
INFO:root:iteration: 1000,   train accuracy: 48.45,   test accuracy: 48.6,   loss: 1.71816,   DP costs: [0.563, 1.119, 1.667],   average batch-size: 1011,   best alpha: [28.09, 15.84, 11.5],   time: 281
INFO:root:iteration: 1100,   train accuracy: 49.56,   test accuracy: 49.21,   loss: 1.34481,   DP costs: [0.592, 1.177, 1.755],   average batch-size: 1006,   best alpha: [26.89, 15.24, 11.08],   time: 308
INFO:root:iteration: 1200,   train accuracy: 50.77,   test accuracy: 50.47,   loss: 1.47709,   DP costs: [0.62, 1.233, 1.839],   average batch-size: 1020,   best alpha: [25.95, 14.67, 10.67],   time: 336
INFO:root:iteration: 1300,   train accuracy: 52.03,   test accuracy: 51.44,   loss: 1.37123,   DP costs: [0.647, 1.287, 1.92],   average batch-size: 1015,   best alpha: [25.04, 14.17, 10.32],   time: 363
INFO:root:iteration: 1400,   train accuracy: 51.41,   test accuracy: 51.8,   loss: 1.49097,   DP costs: [0.673, 1.339, 1.998],   average batch-size: 1014,   best alpha: [24.26, 13.74, 10.02],   time: 391
INFO:root:iteration: 1500,   train accuracy: 53.08,   test accuracy: 52.76,   loss: 1.50832,   DP costs: [0.698, 1.389, 2.074],   average batch-size: 1033,   best alpha: [23.5, 13.38, 9.72],   time: 419
INFO:root:iteration: 1600,   train accuracy: 54.17,   test accuracy: 53.31,   loss: 1.52808,   DP costs: [0.722, 1.438, 2.148],   average batch-size: 1003,   best alpha: [22.86, 13.03, 9.48],   time: 446
INFO:root:iteration: 1700,   train accuracy: 55.29,   test accuracy: 54.38,   loss: 1.76469,   DP costs: [0.746, 1.486, 2.22],   average batch-size: 1025,   best alpha: [22.33, 12.68, 9.23],   time: 474
INFO:root:iteration: 1800,   train accuracy: 54.8,   test accuracy: 54.63,   loss: 1.44478,   DP costs: [0.769, 1.532, 2.29],   average batch-size: 1050,   best alpha: [21.72, 12.4, 9.03],   time: 502
INFO:root:iteration: 1900,   train accuracy: 55.96,   test accuracy: 55.1,   loss: 1.45359,   DP costs: [0.791, 1.578, 2.358],   average batch-size: 1011,   best alpha: [21.21, 12.12, 8.84],   time: 530
INFO:root:iteration: 2000,   train accuracy: 55.69,   test accuracy: 55.78,   loss: 1.59602,   DP costs: [0.813, 1.622, 2.425],   average batch-size: 1034,   best alpha: [20.8, 11.85, 8.64],   time: 557
INFO:root:iteration: 2100,   train accuracy: 56.75,   test accuracy: 56.16,   loss: 1.43562,   DP costs: [0.835, 1.665, 2.491],   average batch-size: 1022,   best alpha: [20.32, 11.58, 8.49],   time: 585
INFO:root:iteration: 2200,   train accuracy: 57.15,   test accuracy: 56.91,   loss: 1.41567,   DP costs: [0.856, 1.707, 2.555],   average batch-size: 992,   best alpha: [19.92, 11.37, 8.34],   time: 612
INFO:root:iteration: 2300,   train accuracy: 57.21,   test accuracy: 56.52,   loss: 1.32683,   DP costs: [0.876, 1.749, 2.618],   average batch-size: 1017,   best alpha: [19.54, 11.16, 8.19],   time: 639
INFO:root:iteration: 2400,   train accuracy: 57.37,   test accuracy: 57.13,   loss: 1.32895,   DP costs: [0.896, 1.79, 2.68],   average batch-size: 1036,   best alpha: [19.23, 10.99, 8.04],   time: 668
INFO:root:iteration: 2500,   train accuracy: 57.88,   test accuracy: 58.13,   loss: 1.21074,   DP costs: [0.916, 1.83, 2.741],   average batch-size: 1007,   best alpha: [18.86, 10.79, 7.9],   time: 695
INFO:root:iteration: 2600,   train accuracy: 59.26,   test accuracy: 58.0,   loss: 1.38815,   DP costs: [0.935, 1.869, 2.8],   average batch-size: 1022,   best alpha: [18.57, 10.63, 7.78],   time: 722
INFO:root:iteration: 2700,   train accuracy: 59.05,   test accuracy: 57.76,   loss: 1.24644,   DP costs: [0.955, 1.908, 2.859],   average batch-size: 1007,   best alpha: [18.21, 10.43, 7.67],   time: 750
INFO:root:iteration: 2800,   train accuracy: 59.43,   test accuracy: 58.3,   loss: 1.70323,   DP costs: [0.973, 1.946, 2.917],   average batch-size: 1006,   best alpha: [17.93, 10.27, 7.56],   time: 777
INFO:root:iteration: 2900,   train accuracy: 59.32,   test accuracy: 58.54,   loss: 1.33346,   DP costs: [0.992, 1.983, 2.974],   average batch-size: 1014,   best alpha: [17.65, 10.12, 7.46],   time: 804
INFO:root:iteration: 2929,   train accuracy: 59.9,   test accuracy: 58.76,   loss: 1.42288,   DP costs: [0.997, 1.994, 2.99],   average batch-size: 1017,   best alpha: [17.58, 10.09, 7.43],   time: 816
INFO:root:Terminate: The maximum of iterations is reached!
