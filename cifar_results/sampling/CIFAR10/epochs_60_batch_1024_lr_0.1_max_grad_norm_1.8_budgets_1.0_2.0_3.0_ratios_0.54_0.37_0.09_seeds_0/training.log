INFO:root:Input args: Namespace(dname='CIFAR10', seeds=[0], architecture='CIFAR10_CNN', accountant='rdp', individualize='sampling', log_iteration=100, lr=0.1, momentum=0.5, epochs=60, n_workers=6, batch_size=1024, max_physical_batch_size=128, delta=1e-05, budgets=[1.0, 2.0, 3.0], ratios=[0.54, 0.37, 0.09], max_grad_norm=1.8, noise_multiplier=3.14049, weights=None, adapt_weights_to_budgets=True, use_cuda='True', save_path='../cifar_results/sampling/CIFAR10/epochs_60_batch_1024_lr_0.1_max_grad_norm_1.8_budgets_1.0_2.0_3.0_ratios_0.54_0.37_0.09_seeds_0', mode='mia', accuracy_log='accuracy.log', assign_budget='random', class_budgets=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], mia_ndata=50000, mia_count=0, allow_excess=False, save_model='True')
INFO:root:seed: 0,   max_iteration: 2930,   1 epoch ~= 49 iterations
INFO:root:seed: 0,   max_iteration: 2930,   1 epoch ~= 49 iterations
INFO:root:Initializing privacy parameters:   max_grad_norm=1.8,   sample_rate=0.02040816326530612,   noise_multiplier 3.1404914550781253,   individual sample_rates=[0.013769532112304687, 0.025927735115722658, 0.03735351625146485]
INFO:root:iteration: 0,   train accuracy: 10.28,   test accuracy: 10.2,   loss: 2.30348,   DP costs: [0.074, 0.092, 0.108],   average batch-size: 932,   best alpha: [84.41, 71.52, 63.98],   time: 1
INFO:root:iteration: 100,   train accuracy: 28.07,   test accuracy: 28.73,   loss: 1.98571,   DP costs: [0.171, 0.338, 0.501],   average batch-size: 1034,   best alpha: [75.0, 41.72, 29.88],   time: 30
INFO:root:iteration: 200,   train accuracy: 33.02,   test accuracy: 33.96,   loss: 1.90388,   DP costs: [0.243, 0.481, 0.713],   average batch-size: 1022,   best alpha: [56.45, 31.51, 22.55],   time: 58
INFO:root:iteration: 300,   train accuracy: 37.43,   test accuracy: 38.0,   loss: 1.64029,   DP costs: [0.299, 0.593, 0.88],   average batch-size: 1011,   best alpha: [47.44, 26.56, 19.12],   time: 86
INFO:root:iteration: 400,   train accuracy: 39.73,   test accuracy: 40.9,   loss: 1.48539,   DP costs: [0.347, 0.689, 1.023],   average batch-size: 1024,   best alpha: [42.03, 23.58, 16.95],   time: 114
INFO:root:iteration: 500,   train accuracy: 42.45,   test accuracy: 42.78,   loss: 1.59753,   DP costs: [0.39, 0.774, 1.151],   average batch-size: 1016,   best alpha: [38.17, 21.45, 15.45],   time: 142
INFO:root:iteration: 600,   train accuracy: 43.55,   test accuracy: 44.3,   loss: 1.66642,   DP costs: [0.43, 0.852, 1.267],   average batch-size: 1028,   best alpha: [35.22, 19.83, 14.3],   time: 170
INFO:root:iteration: 700,   train accuracy: 45.33,   test accuracy: 45.4,   loss: 1.46972,   DP costs: [0.466, 0.924, 1.376],   average batch-size: 1006,   best alpha: [33.04, 18.56, 13.4],   time: 197
INFO:root:iteration: 800,   train accuracy: 46.26,   test accuracy: 46.43,   loss: 1.59311,   DP costs: [0.5, 0.992, 1.477],   average batch-size: 1012,   best alpha: [31.12, 17.51, 12.71],   time: 225
INFO:root:iteration: 900,   train accuracy: 47.37,   test accuracy: 47.8,   loss: 1.35669,   DP costs: [0.532, 1.056, 1.574],   average batch-size: 1026,   best alpha: [29.54, 16.71, 12.09],   time: 253
INFO:root:iteration: 1000,   train accuracy: 48.61,   test accuracy: 48.03,   loss: 1.26898,   DP costs: [0.562, 1.117, 1.665],   average batch-size: 1022,   best alpha: [28.28, 15.95, 11.56],   time: 280
INFO:root:iteration: 1100,   train accuracy: 50.02,   test accuracy: 49.57,   loss: 1.55007,   DP costs: [0.591, 1.176, 1.753],   average batch-size: 1019,   best alpha: [27.07, 15.29, 11.13],   time: 308
INFO:root:iteration: 1200,   train accuracy: 50.48,   test accuracy: 49.75,   loss: 1.35673,   DP costs: [0.619, 1.232, 1.837],   average batch-size: 1022,   best alpha: [26.12, 14.77, 10.72],   time: 336
INFO:root:iteration: 1300,   train accuracy: 51.6,   test accuracy: 51.2,   loss: 1.33371,   DP costs: [0.646, 1.286, 1.919],   average batch-size: 1017,   best alpha: [25.2, 14.27, 10.37],   time: 363
INFO:root:iteration: 1400,   train accuracy: 51.12,   test accuracy: 51.75,   loss: 1.36824,   DP costs: [0.672, 1.338, 1.997],   average batch-size: 1009,   best alpha: [24.32, 13.84, 10.06],   time: 391
INFO:root:iteration: 1500,   train accuracy: 52.9,   test accuracy: 52.55,   loss: 1.45886,   DP costs: [0.697, 1.388, 2.074],   average batch-size: 1022,   best alpha: [23.66, 13.42, 9.77],   time: 418
INFO:root:iteration: 1600,   train accuracy: 53.76,   test accuracy: 53.37,   loss: 1.38746,   DP costs: [0.722, 1.437, 2.148],   average batch-size: 1008,   best alpha: [23.01, 13.07, 9.52],   time: 446
INFO:root:iteration: 1700,   train accuracy: 54.35,   test accuracy: 53.41,   loss: 1.43299,   DP costs: [0.745, 1.485, 2.22],   average batch-size: 1026,   best alpha: [22.39, 12.72, 9.28],   time: 473
INFO:root:iteration: 1800,   train accuracy: 54.49,   test accuracy: 54.42,   loss: 1.20048,   DP costs: [0.769, 1.532, 2.29],   average batch-size: 1034,   best alpha: [21.87, 12.44, 9.08],   time: 501
INFO:root:iteration: 1900,   train accuracy: 55.44,   test accuracy: 54.76,   loss: 1.14638,   DP costs: [0.791, 1.577, 2.359],   average batch-size: 1025,   best alpha: [21.36, 12.16, 8.88],   time: 529
INFO:root:iteration: 2000,   train accuracy: 55.54,   test accuracy: 55.45,   loss: 1.56834,   DP costs: [0.813, 1.621, 2.426],   average batch-size: 1016,   best alpha: [20.86, 11.88, 8.69],   time: 556
INFO:root:iteration: 2100,   train accuracy: 56.27,   test accuracy: 55.29,   loss: 1.44249,   DP costs: [0.835, 1.665, 2.492],   average batch-size: 1030,   best alpha: [20.37, 11.62, 8.5],   time: 584
INFO:root:iteration: 2200,   train accuracy: 56.32,   test accuracy: 55.79,   loss: 1.3781,   DP costs: [0.856, 1.707, 2.556],   average batch-size: 1000,   best alpha: [19.98, 11.4, 8.35],   time: 611
INFO:root:iteration: 2300,   train accuracy: 56.42,   test accuracy: 56.01,   loss: 1.34049,   DP costs: [0.876, 1.749, 2.619],   average batch-size: 1021,   best alpha: [19.59, 11.19, 8.2],   time: 638
INFO:root:iteration: 2400,   train accuracy: 57.19,   test accuracy: 56.48,   loss: 1.27776,   DP costs: [0.896, 1.79, 2.682],   average batch-size: 1033,   best alpha: [19.29, 10.98, 8.05],   time: 666
INFO:root:iteration: 2500,   train accuracy: 56.73,   test accuracy: 57.45,   loss: 1.42434,   DP costs: [0.916, 1.83, 2.743],   average batch-size: 1003,   best alpha: [18.91, 10.82, 7.93],   time: 693
INFO:root:iteration: 2600,   train accuracy: 58.29,   test accuracy: 57.18,   loss: 1.2597,   DP costs: [0.936, 1.869, 2.802],   average batch-size: 1024,   best alpha: [18.62, 10.62, 7.79],   time: 721
INFO:root:iteration: 2700,   train accuracy: 58.15,   test accuracy: 57.81,   loss: 1.20066,   DP costs: [0.955, 1.908, 2.862],   average batch-size: 1017,   best alpha: [18.26, 10.46, 7.68],   time: 748
INFO:root:iteration: 2800,   train accuracy: 58.16,   test accuracy: 57.12,   loss: 1.33206,   DP costs: [0.974, 1.946, 2.92],   average batch-size: 1017,   best alpha: [17.98, 10.3, 7.57],   time: 775
INFO:root:iteration: 2900,   train accuracy: 58.63,   test accuracy: 57.56,   loss: 1.3645,   DP costs: [0.992, 1.984, 2.977],   average batch-size: 1012,   best alpha: [17.7, 10.15, 7.46],   time: 803
INFO:root:iteration: 2929,   train accuracy: 58.75,   test accuracy: 57.83,   loss: 1.4123,   DP costs: [0.997, 1.995, 2.993],   average batch-size: 1030,   best alpha: [17.63, 10.11, 7.44],   time: 814
INFO:root:Terminate: The maximum of iterations is reached!
