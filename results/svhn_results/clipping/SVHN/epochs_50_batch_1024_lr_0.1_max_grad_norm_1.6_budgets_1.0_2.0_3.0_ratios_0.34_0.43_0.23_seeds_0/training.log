INFO:root:Input args: Namespace(dname='SVHN', seeds=[0], architecture='CIFAR10_CNN', accountant='rdp', individualize='clipping', log_iteration=100, lr=0.1, momentum=0.5, epochs=50, n_workers=6, batch_size=1024, max_physical_batch_size=1024, delta=1e-05, budgets=[1.0, 2.0, 3.0], ratios=[0.34, 0.43, 0.23], max_grad_norm=1.6, noise_multiplier=2.45703, weights=None, adapt_weights_to_budgets=True, use_cuda='True', save_path='../svhn_results/clipping/SVHN/epochs_50_batch_1024_lr_0.1_max_grad_norm_1.6_budgets_1.0_2.0_3.0_ratios_0.34_0.43_0.23_seeds_0', mode='mia', accuracy_log='accuracy.log', assign_budget='even', class_budgets=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], mia_ndata=73257, mia_count=0, allow_excess=False, save_model='True')
INFO:root:seed: 0,   max_iteration: 3577,   1 epoch ~= 72 iterations
INFO:root:seed: 0,   max_iteration: 3577,   1 epoch ~= 72 iterations
INFO:root:Initializing privacy parameters:   max_grad_norm=1.6,   sample_rate=0.013888888888888888,   noise_multiplier 2.29248046875,   individual max_grad_norms=[1.055056179775281, 1.879174484052533, 2.5314237573715253]
INFO:root:iteration: 0,   train accuracy: 10.9,   test accuracy: 10.01,   loss: 2.30244,   DP costs: [0.059, 0.224, 0.446],   average batch-size: 923,   best alpha: [102.95, 32.85, 18.44],   time: 1
INFO:root:iteration: 100,   train accuracy: 19.06,   test accuracy: 19.59,   loss: 2.24861,   DP costs: [0.152, 0.341, 0.607],   average batch-size: 1035,   best alpha: [83.26, 31.56, 17.18],   time: 12
INFO:root:iteration: 200,   train accuracy: 29.66,   test accuracy: 30.33,   loss: 2.15448,   DP costs: [0.217, 0.447, 0.732],   average batch-size: 928,   best alpha: [62.38, 30.94, 16.85],   time: 22
INFO:root:iteration: 300,   train accuracy: 39.8,   test accuracy: 40.88,   loss: 1.73813,   DP costs: [0.268, 0.545, 0.851],   average batch-size: 1132,   best alpha: [52.41, 27.67, 16.52],   time: 35
INFO:root:iteration: 400,   train accuracy: 49.34,   test accuracy: 51.21,   loss: 1.60171,   DP costs: [0.311, 0.63, 0.966],   average batch-size: 1003,   best alpha: [46.24, 24.67, 16.08],   time: 46
INFO:root:iteration: 500,   train accuracy: 59.01,   test accuracy: 60.34,   loss: 1.31577,   DP costs: [0.35, 0.706, 1.075],   average batch-size: 981,   best alpha: [41.97, 22.62, 15.29],   time: 57
INFO:root:iteration: 600,   train accuracy: 65.68,   test accuracy: 67.16,   loss: 1.12272,   DP costs: [0.385, 0.776, 1.177],   average batch-size: 1031,   best alpha: [38.89, 20.99, 14.38],   time: 69
INFO:root:iteration: 700,   train accuracy: 70.8,   test accuracy: 71.12,   loss: 0.91146,   DP costs: [0.418, 0.84, 1.271],   average batch-size: 1019,   best alpha: [36.32, 19.71, 13.63],   time: 80
INFO:root:iteration: 800,   train accuracy: 73.53,   test accuracy: 74.34,   loss: 0.85035,   DP costs: [0.448, 0.9, 1.36],   average batch-size: 1030,   best alpha: [34.2, 18.66, 12.97],   time: 91
INFO:root:iteration: 900,   train accuracy: 75.99,   test accuracy: 76.18,   loss: 0.79088,   DP costs: [0.477, 0.957, 1.444],   average batch-size: 986,   best alpha: [32.47, 17.81, 12.39],   time: 101
INFO:root:iteration: 1000,   train accuracy: 78.71,   test accuracy: 78.15,   loss: 0.76516,   DP costs: [0.504, 1.011, 1.524],   average batch-size: 969,   best alpha: [31.07, 17.0, 11.93],   time: 112
INFO:root:iteration: 1100,   train accuracy: 79.26,   test accuracy: 79.11,   loss: 0.73206,   DP costs: [0.53, 1.063, 1.601],   average batch-size: 981,   best alpha: [29.74, 16.35, 11.49],   time: 123
INFO:root:iteration: 1200,   train accuracy: 81.09,   test accuracy: 80.29,   loss: 0.76978,   DP costs: [0.555, 1.113, 1.675],   average batch-size: 1011,   best alpha: [28.58, 15.79, 11.11],   time: 133
INFO:root:iteration: 1300,   train accuracy: 81.74,   test accuracy: 80.91,   loss: 0.65143,   DP costs: [0.58, 1.161, 1.746],   average batch-size: 1019,   best alpha: [27.68, 15.25, 10.78],   time: 145
INFO:root:iteration: 1400,   train accuracy: 82.63,   test accuracy: 81.53,   loss: 0.63876,   DP costs: [0.603, 1.207, 1.815],   average batch-size: 988,   best alpha: [26.71, 14.79, 10.5],   time: 156
INFO:root:iteration: 1500,   train accuracy: 82.86,   test accuracy: 82.15,   loss: 0.59563,   DP costs: [0.625, 1.252, 1.881],   average batch-size: 980,   best alpha: [25.98, 14.4, 10.19],   time: 166
INFO:root:iteration: 1600,   train accuracy: 84.4,   test accuracy: 82.57,   loss: 0.71017,   DP costs: [0.647, 1.295, 1.946],   average batch-size: 1060,   best alpha: [25.27, 14.02, 9.97],   time: 178
INFO:root:iteration: 1700,   train accuracy: 84.49,   test accuracy: 83.04,   loss: 0.60917,   DP costs: [0.669, 1.338, 2.009],   average batch-size: 1006,   best alpha: [24.58, 13.65, 9.71],   time: 188
INFO:root:iteration: 1800,   train accuracy: 84.88,   test accuracy: 83.25,   loss: 0.59913,   DP costs: [0.689, 1.379, 2.07],   average batch-size: 1001,   best alpha: [23.91, 13.34, 9.5],   time: 199
INFO:root:iteration: 1900,   train accuracy: 84.63,   test accuracy: 83.6,   loss: 0.52009,   DP costs: [0.71, 1.419, 2.13],   average batch-size: 1007,   best alpha: [23.35, 13.04, 9.33],   time: 210
INFO:root:iteration: 2000,   train accuracy: 85.19,   test accuracy: 83.76,   loss: 0.53229,   DP costs: [0.729, 1.458, 2.189],   average batch-size: 1037,   best alpha: [22.89, 12.79, 9.12],   time: 220
INFO:root:iteration: 2100,   train accuracy: 85.75,   test accuracy: 83.99,   loss: 0.58701,   DP costs: [0.749, 1.497, 2.246],   average batch-size: 1076,   best alpha: [22.36, 12.5, 8.96],   time: 230
INFO:root:iteration: 2200,   train accuracy: 85.72,   test accuracy: 84.21,   loss: 0.60649,   DP costs: [0.767, 1.535, 2.302],   average batch-size: 1036,   best alpha: [21.92, 12.27, 8.8],   time: 240
INFO:root:iteration: 2300,   train accuracy: 86.11,   test accuracy: 84.44,   loss: 0.55901,   DP costs: [0.786, 1.571, 2.358],   average batch-size: 1109,   best alpha: [21.49, 12.04, 8.67],   time: 251
INFO:root:iteration: 2400,   train accuracy: 86.24,   test accuracy: 84.57,   loss: 0.65563,   DP costs: [0.804, 1.608, 2.412],   average batch-size: 967,   best alpha: [21.08, 11.86, 8.51],   time: 262
INFO:root:iteration: 2500,   train accuracy: 86.25,   test accuracy: 84.73,   loss: 0.60269,   DP costs: [0.822, 1.643, 2.465],   average batch-size: 972,   best alpha: [20.75, 11.63, 8.39],   time: 272
INFO:root:iteration: 2600,   train accuracy: 86.19,   test accuracy: 84.97,   loss: 0.62994,   DP costs: [0.839, 1.678, 2.517],   average batch-size: 991,   best alpha: [20.35, 11.46, 8.27],   time: 283
INFO:root:iteration: 2700,   train accuracy: 86.64,   test accuracy: 85.0,   loss: 0.53806,   DP costs: [0.857, 1.713, 2.569],   average batch-size: 954,   best alpha: [20.03, 11.29, 8.12],   time: 294
INFO:root:iteration: 2800,   train accuracy: 86.51,   test accuracy: 85.07,   loss: 0.49311,   DP costs: [0.873, 1.746, 2.619],   average batch-size: 1033,   best alpha: [19.72, 11.12, 8.03],   time: 304
INFO:root:iteration: 2900,   train accuracy: 86.75,   test accuracy: 85.16,   loss: 0.50753,   DP costs: [0.89, 1.78, 2.669],   average batch-size: 1055,   best alpha: [19.41, 10.96, 7.92],   time: 315
INFO:root:iteration: 3000,   train accuracy: 86.41,   test accuracy: 85.51,   loss: 0.81541,   DP costs: [0.906, 1.812, 2.718],   average batch-size: 1049,   best alpha: [19.11, 10.79, 7.8],   time: 325
INFO:root:iteration: 3100,   train accuracy: 87.16,   test accuracy: 85.66,   loss: 0.55077,   DP costs: [0.922, 1.845, 2.767],   average batch-size: 1005,   best alpha: [18.89, 10.67, 7.72],   time: 336
INFO:root:iteration: 3200,   train accuracy: 87.33,   test accuracy: 85.58,   loss: 0.44091,   DP costs: [0.938, 1.877, 2.815],   average batch-size: 993,   best alpha: [18.59, 10.51, 7.61],   time: 347
INFO:root:iteration: 3300,   train accuracy: 87.09,   test accuracy: 85.63,   loss: 0.50419,   DP costs: [0.954, 1.908, 2.862],   average batch-size: 982,   best alpha: [18.38, 10.4, 7.53],   time: 358
INFO:root:iteration: 3400,   train accuracy: 86.98,   test accuracy: 85.78,   loss: 0.44806,   DP costs: [0.969, 1.939, 2.909],   average batch-size: 985,   best alpha: [18.09, 10.24, 7.45],   time: 367
INFO:root:iteration: 3500,   train accuracy: 87.37,   test accuracy: 85.8,   loss: 0.46393,   DP costs: [0.985, 1.97, 2.955],   average batch-size: 981,   best alpha: [17.88, 10.13, 7.37],   time: 376
INFO:root:iteration: 3576,   train accuracy: 87.23,   test accuracy: 85.74,   loss: 0.41401,   DP costs: [0.996, 1.993, 2.989],   average batch-size: 963,   best alpha: [17.68, 10.05, 7.29],   time: 385
INFO:root:Terminate: The maximum of iterations is reached!
