INFO:root:Input args: Namespace(dname='SVHN', seeds=[0], architecture='CIFAR10_CNN', accountant='rdp', individualize='sampling', log_iteration=100, lr=0.2, momentum=0.5, epochs=80, n_workers=6, batch_size=1024, max_physical_batch_size=1024, delta=1e-05, budgets=[1.0, 2.0, 3.0], ratios=[0.34, 0.43, 0.23], max_grad_norm=0.6, noise_multiplier=2.53261, weights=None, adapt_weights_to_budgets=True, use_cuda='True', save_path='../svhn_results/sampling/SVHN/epochs_80_batch_1024_lr_0.2_max_grad_norm_0.6_budgets_1.0_2.0_3.0_ratios_0.34_0.43_0.23_seeds_0', mode='mia', accuracy_log='accuracy.log', assign_budget='even', class_budgets=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], mia_ndata=73257, mia_count=0, allow_excess=False, save_model='True')
INFO:root:seed: 0,   max_iteration: 5723,   1 epoch ~= 72 iterations
INFO:root:seed: 0,   max_iteration: 5723,   1 epoch ~= 72 iterations
INFO:root:Initializing privacy parameters:   max_grad_norm=0.6,   sample_rate=0.013888888888888888,   noise_multiplier 2.4178713378906256,   individual sample_rates=[0.007446289988037109, 0.014025879765991213, 0.020190430485595705]
INFO:root:iteration: 0,   train accuracy: 10.71,   test accuracy: 10.06,   loss: 2.29948,   DP costs: [0.115, 0.137, 0.154],   average batch-size: 921,   best alpha: [57.52, 49.94, 45.61],   time: 1
INFO:root:iteration: 100,   train accuracy: 18.89,   test accuracy: 19.59,   loss: 2.25377,   DP costs: [0.15, 0.244, 0.358],   average batch-size: 1010,   best alpha: [56.37, 48.54, 38.82],   time: 11
INFO:root:iteration: 200,   train accuracy: 18.87,   test accuracy: 19.59,   loss: 2.22888,   DP costs: [0.182, 0.341, 0.505],   average batch-size: 1007,   best alpha: [56.14, 41.48, 29.69],   time: 22
INFO:root:iteration: 300,   train accuracy: 19.11,   test accuracy: 19.59,   loss: 2.23788,   DP costs: [0.213, 0.418, 0.62],   average batch-size: 1105,   best alpha: [55.91, 35.18, 25.23],   time: 33
INFO:root:iteration: 400,   train accuracy: 18.9,   test accuracy: 19.59,   loss: 2.21043,   DP costs: [0.245, 0.485, 0.719],   average batch-size: 1042,   best alpha: [55.46, 31.33, 22.41],   time: 44
INFO:root:iteration: 500,   train accuracy: 18.41,   test accuracy: 19.59,   loss: 2.26032,   DP costs: [0.275, 0.544, 0.808],   average batch-size: 943,   best alpha: [50.94, 28.47, 20.47],   time: 55
INFO:root:iteration: 600,   train accuracy: 19.06,   test accuracy: 19.59,   loss: 2.2265,   DP costs: [0.302, 0.598, 0.888],   average batch-size: 978,   best alpha: [47.18, 26.4, 19.0],   time: 66
INFO:root:iteration: 700,   train accuracy: 18.77,   test accuracy: 19.59,   loss: 2.27266,   DP costs: [0.327, 0.649, 0.963],   average batch-size: 926,   best alpha: [44.23, 24.68, 17.79],   time: 76
INFO:root:iteration: 800,   train accuracy: 18.86,   test accuracy: 19.59,   loss: 2.25825,   DP costs: [0.351, 0.695, 1.033],   average batch-size: 1062,   best alpha: [41.64, 23.35, 16.84],   time: 87
INFO:root:iteration: 900,   train accuracy: 18.84,   test accuracy: 19.59,   loss: 2.23893,   DP costs: [0.373, 0.74, 1.099],   average batch-size: 973,   best alpha: [39.68, 22.19, 16.02],   time: 98
INFO:root:iteration: 1000,   train accuracy: 18.94,   test accuracy: 19.59,   loss: 2.22356,   DP costs: [0.394, 0.782, 1.162],   average batch-size: 1025,   best alpha: [37.81, 21.25, 15.35],   time: 107
INFO:root:iteration: 1100,   train accuracy: 18.79,   test accuracy: 19.59,   loss: 2.22726,   DP costs: [0.414, 0.822, 1.222],   average batch-size: 1068,   best alpha: [36.32, 20.43, 14.71],   time: 118
INFO:root:iteration: 1200,   train accuracy: 19.06,   test accuracy: 19.59,   loss: 2.25531,   DP costs: [0.434, 0.861, 1.28],   average batch-size: 1031,   best alpha: [35.03, 19.64, 14.21],   time: 129
INFO:root:iteration: 1300,   train accuracy: 18.99,   test accuracy: 19.59,   loss: 2.24537,   DP costs: [0.452, 0.898, 1.336],   average batch-size: 1009,   best alpha: [33.79, 19.04, 13.73],   time: 139
INFO:root:iteration: 1400,   train accuracy: 18.99,   test accuracy: 19.59,   loss: 2.2298,   DP costs: [0.47, 0.934, 1.389],   average batch-size: 1016,   best alpha: [32.73, 18.38, 13.32],   time: 150
INFO:root:iteration: 1500,   train accuracy: 18.95,   test accuracy: 19.59,   loss: 2.26253,   DP costs: [0.488, 0.969, 1.442],   average batch-size: 1060,   best alpha: [31.7, 17.89, 12.92],   time: 160
INFO:root:iteration: 1600,   train accuracy: 18.99,   test accuracy: 19.59,   loss: 2.25064,   DP costs: [0.505, 1.003, 1.492],   average batch-size: 992,   best alpha: [30.83, 17.41, 12.58],   time: 171
INFO:root:iteration: 1700,   train accuracy: 18.95,   test accuracy: 19.59,   loss: 2.20525,   DP costs: [0.521, 1.036, 1.542],   average batch-size: 915,   best alpha: [30.1, 16.94, 12.3],   time: 181
INFO:root:iteration: 1800,   train accuracy: 18.76,   test accuracy: 19.59,   loss: 2.26515,   DP costs: [0.537, 1.068, 1.59],   average batch-size: 998,   best alpha: [29.27, 16.55, 11.98],   time: 191
INFO:root:iteration: 1900,   train accuracy: 19.11,   test accuracy: 19.59,   loss: 2.23961,   DP costs: [0.553, 1.099, 1.636],   average batch-size: 945,   best alpha: [28.69, 16.17, 11.71],   time: 202
INFO:root:iteration: 2000,   train accuracy: 18.9,   test accuracy: 19.6,   loss: 2.24911,   DP costs: [0.568, 1.129, 1.682],   average batch-size: 999,   best alpha: [28.02, 15.8, 11.49],   time: 212
INFO:root:iteration: 2100,   train accuracy: 18.94,   test accuracy: 19.6,   loss: 2.23913,   DP costs: [0.583, 1.159, 1.727],   average batch-size: 1131,   best alpha: [27.47, 15.5, 11.23],   time: 223
INFO:root:iteration: 2200,   train accuracy: 19.2,   test accuracy: 19.59,   loss: 2.23409,   DP costs: [0.598, 1.188, 1.771],   average batch-size: 1098,   best alpha: [26.82, 15.2, 11.02],   time: 234
INFO:root:iteration: 2300,   train accuracy: 18.94,   test accuracy: 19.59,   loss: 2.23074,   DP costs: [0.612, 1.217, 1.814],   average batch-size: 1057,   best alpha: [26.4, 14.91, 10.82],   time: 244
INFO:root:iteration: 2400,   train accuracy: 18.91,   test accuracy: 19.56,   loss: 2.25626,   DP costs: [0.626, 1.245, 1.856],   average batch-size: 959,   best alpha: [25.88, 14.63, 10.62],   time: 253
INFO:root:iteration: 2500,   train accuracy: 19.1,   test accuracy: 19.65,   loss: 2.24628,   DP costs: [0.64, 1.273, 1.898],   average batch-size: 990,   best alpha: [25.37, 14.41, 10.46],   time: 262
INFO:root:iteration: 2600,   train accuracy: 19.2,   test accuracy: 19.63,   loss: 2.26069,   DP costs: [0.653, 1.3, 1.938],   average batch-size: 941,   best alpha: [24.97, 14.13, 10.31],   time: 272
INFO:root:iteration: 2700,   train accuracy: 19.16,   test accuracy: 19.72,   loss: 2.21079,   DP costs: [0.666, 1.326, 1.979],   average batch-size: 991,   best alpha: [24.58, 13.92, 10.12],   time: 283
INFO:root:iteration: 2800,   train accuracy: 18.76,   test accuracy: 19.66,   loss: 2.26099,   DP costs: [0.679, 1.352, 2.018],   average batch-size: 1011,   best alpha: [24.19, 13.71, 9.97],   time: 293
INFO:root:iteration: 2900,   train accuracy: 18.92,   test accuracy: 19.74,   loss: 2.22489,   DP costs: [0.692, 1.378, 2.057],   average batch-size: 1143,   best alpha: [23.81, 13.5, 9.82],   time: 305
INFO:root:iteration: 3000,   train accuracy: 18.67,   test accuracy: 19.79,   loss: 2.24484,   DP costs: [0.705, 1.404, 2.095],   average batch-size: 1010,   best alpha: [23.44, 13.29, 9.71],   time: 315
INFO:root:iteration: 3100,   train accuracy: 18.47,   test accuracy: 19.0,   loss: 2.2667,   DP costs: [0.717, 1.429, 2.133],   average batch-size: 1022,   best alpha: [23.07, 13.14, 9.57],   time: 325
INFO:root:iteration: 3200,   train accuracy: 18.95,   test accuracy: 19.56,   loss: 2.22428,   DP costs: [0.729, 1.453, 2.17],   average batch-size: 1048,   best alpha: [22.8, 12.94, 9.43],   time: 336
INFO:root:iteration: 3300,   train accuracy: 18.71,   test accuracy: 19.76,   loss: 2.22982,   DP costs: [0.741, 1.478, 2.207],   average batch-size: 1047,   best alpha: [22.53, 12.8, 9.33],   time: 347
INFO:root:iteration: 3400,   train accuracy: 18.55,   test accuracy: 19.24,   loss: 2.24459,   DP costs: [0.753, 1.502, 2.243],   average batch-size: 965,   best alpha: [22.18, 12.6, 9.22],   time: 357
INFO:root:iteration: 3500,   train accuracy: 18.67,   test accuracy: 19.68,   loss: 2.24183,   DP costs: [0.765, 1.525, 2.279],   average batch-size: 986,   best alpha: [21.92, 12.46, 9.09],   time: 367
INFO:root:iteration: 3600,   train accuracy: 18.97,   test accuracy: 20.0,   loss: 2.24279,   DP costs: [0.777, 1.549, 2.314],   average batch-size: 990,   best alpha: [21.66, 12.32, 8.99],   time: 376
INFO:root:iteration: 3700,   train accuracy: 18.97,   test accuracy: 19.63,   loss: 2.2097,   DP costs: [0.788, 1.572, 2.349],   average batch-size: 1043,   best alpha: [21.41, 12.18, 8.89],   time: 386
INFO:root:iteration: 3800,   train accuracy: 18.62,   test accuracy: 18.04,   loss: 2.22562,   DP costs: [0.799, 1.595, 2.384],   average batch-size: 1020,   best alpha: [21.16, 12.04, 8.8],   time: 397
INFO:root:iteration: 3900,   train accuracy: 19.26,   test accuracy: 19.06,   loss: 2.22539,   DP costs: [0.811, 1.617, 2.418],   average batch-size: 1006,   best alpha: [20.91, 11.91, 8.7],   time: 407
INFO:root:iteration: 4000,   train accuracy: 18.71,   test accuracy: 17.85,   loss: 2.22212,   DP costs: [0.822, 1.64, 2.452],   average batch-size: 1026,   best alpha: [20.67, 11.77, 8.6],   time: 417
INFO:root:iteration: 4100,   train accuracy: 18.55,   test accuracy: 18.47,   loss: 2.23529,   DP costs: [0.833, 1.662, 2.485],   average batch-size: 1041,   best alpha: [20.42, 11.64, 8.54],   time: 428
INFO:root:iteration: 4200,   train accuracy: 18.56,   test accuracy: 19.16,   loss: 2.25231,   DP costs: [0.843, 1.683, 2.518],   average batch-size: 985,   best alpha: [20.27, 11.55, 8.45],   time: 439
INFO:root:iteration: 4300,   train accuracy: 18.61,   test accuracy: 18.81,   loss: 2.20043,   DP costs: [0.854, 1.705, 2.551],   average batch-size: 1050,   best alpha: [20.03, 11.42, 8.36],   time: 449
INFO:root:iteration: 4400,   train accuracy: 18.33,   test accuracy: 17.85,   loss: 2.22685,   DP costs: [0.865, 1.726, 2.583],   average batch-size: 1066,   best alpha: [19.79, 11.3, 8.3],   time: 460
INFO:root:iteration: 4500,   train accuracy: 18.73,   test accuracy: 17.43,   loss: 2.23609,   DP costs: [0.875, 1.748, 2.616],   average batch-size: 1035,   best alpha: [19.64, 11.21, 8.21],   time: 470
INFO:root:iteration: 4600,   train accuracy: 18.25,   test accuracy: 17.48,   loss: 2.2512,   DP costs: [0.886, 1.769, 2.647],   average batch-size: 1064,   best alpha: [19.49, 11.09, 8.15],   time: 480
INFO:root:iteration: 4700,   train accuracy: 18.53,   test accuracy: 18.36,   loss: 2.20815,   DP costs: [0.896, 1.789, 2.679],   average batch-size: 1040,   best alpha: [19.26, 11.0, 8.06],   time: 490
INFO:root:iteration: 4800,   train accuracy: 18.26,   test accuracy: 18.58,   loss: 2.21246,   DP costs: [0.906, 1.81, 2.71],   average batch-size: 1026,   best alpha: [19.11, 10.92, 8.0],   time: 501
INFO:root:iteration: 4900,   train accuracy: 18.9,   test accuracy: 18.62,   loss: 2.23308,   DP costs: [0.916, 1.83, 2.741],   average batch-size: 995,   best alpha: [18.89, 10.8, 7.92],   time: 512
INFO:root:iteration: 5000,   train accuracy: 18.89,   test accuracy: 18.73,   loss: 2.23241,   DP costs: [0.926, 1.851, 2.772],   average batch-size: 1012,   best alpha: [18.74, 10.72, 7.86],   time: 522
INFO:root:iteration: 5100,   train accuracy: 18.55,   test accuracy: 18.04,   loss: 2.23502,   DP costs: [0.936, 1.871, 2.802],   average batch-size: 1030,   best alpha: [18.59, 10.64, 7.8],   time: 532
INFO:root:iteration: 5200,   train accuracy: 18.75,   test accuracy: 18.42,   loss: 2.23269,   DP costs: [0.946, 1.891, 2.833],   average batch-size: 1022,   best alpha: [18.45, 10.56, 7.75],   time: 543
INFO:root:iteration: 5300,   train accuracy: 18.69,   test accuracy: 17.96,   loss: 2.23053,   DP costs: [0.955, 1.91, 2.863],   average batch-size: 1102,   best alpha: [18.31, 10.48, 7.69],   time: 553
INFO:root:iteration: 5400,   train accuracy: 18.97,   test accuracy: 18.2,   loss: 2.24623,   DP costs: [0.965, 1.93, 2.892],   average batch-size: 1103,   best alpha: [18.16, 10.36, 7.64],   time: 564
INFO:root:iteration: 5500,   train accuracy: 18.69,   test accuracy: 18.7,   loss: 2.25696,   DP costs: [0.975, 1.949, 2.922],   average batch-size: 1032,   best alpha: [18.02, 10.29, 7.56],   time: 575
INFO:root:iteration: 5600,   train accuracy: 18.78,   test accuracy: 18.61,   loss: 2.20443,   DP costs: [0.984, 1.969, 2.951],   average batch-size: 1030,   best alpha: [17.81, 10.21, 7.5],   time: 586
INFO:root:iteration: 5700,   train accuracy: 19.02,   test accuracy: 18.87,   loss: 2.21608,   DP costs: [0.994, 1.988, 2.98],   average batch-size: 1009,   best alpha: [17.68, 10.14, 7.45],   time: 596
INFO:root:iteration: 5722,   train accuracy: 17.91,   test accuracy: 17.94,   loss: 2.26612,   DP costs: [0.996, 1.992, 2.987],   average batch-size: 958,   best alpha: [17.68, 10.14, 7.45],   time: 603
INFO:root:Terminate: The maximum of iterations is reached!
