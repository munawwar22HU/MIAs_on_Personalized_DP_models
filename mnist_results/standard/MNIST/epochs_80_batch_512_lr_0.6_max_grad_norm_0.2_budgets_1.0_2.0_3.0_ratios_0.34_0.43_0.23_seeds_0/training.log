INFO:root:Input args: Namespace(dname='MNIST', seeds=[0], architecture='MNIST_CNN', accountant='rdp', individualize=None, log_iteration=100, lr=0.6, momentum=0.5, epochs=80, n_workers=6, batch_size=512, max_physical_batch_size=512, delta=1e-05, budgets=[1.0, 2.0, 3.0], ratios=[0.34, 0.43, 0.23], max_grad_norm=0.2, noise_multiplier=3.42529, weights=None, adapt_weights_to_budgets=True, use_cuda='True', save_path='../mnist_results/standard/MNIST/epochs_80_batch_512_lr_0.6_max_grad_norm_0.2_budgets_1.0_2.0_3.0_ratios_0.34_0.43_0.23_seeds_0', mode='mia', accuracy_log='accuracy.log', assign_budget='random', class_budgets=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], mia_ndata=60000, mia_count=0, allow_excess=False, save_model='True')
INFO:root:seed: 0,   max_iteration: 9375,   1 epoch ~= 117 iterations
INFO:root:seed: 0,   max_iteration: 9375,   1 epoch ~= 117 iterations
INFO:root:Initializing privacy parameters:   max_grad_norm=0.2,   sample_rate=0.00847457627118644,   noise_multiplier 3.42529296875,   no individual parameters
INFO:root:iteration: 0,   train accuracy: 10.14,   test accuracy: 10.09,   loss: 2.31319,   DP costs: 0.053,   average batch-size: 513,   best alpha: 111.95,   time: 1
INFO:root:iteration: 100,   train accuracy: 70.39,   test accuracy: 71.97,   loss: 1.19796,   DP costs: 0.092,   average batch-size: 497,   best alpha: 110.59,   time: 14
INFO:root:iteration: 200,   train accuracy: 79.69,   test accuracy: 80.57,   loss: 0.62169,   DP costs: 0.129,   average batch-size: 518,   best alpha: 97.04,   time: 27
INFO:root:iteration: 300,   train accuracy: 86.29,   test accuracy: 86.64,   loss: 0.49278,   DP costs: 0.16,   average batch-size: 509,   best alpha: 81.43,   time: 39
INFO:root:iteration: 400,   train accuracy: 88.86,   test accuracy: 89.85,   loss: 0.38851,   DP costs: 0.186,   average batch-size: 516,   best alpha: 72.07,   time: 52
INFO:root:iteration: 500,   train accuracy: 91.49,   test accuracy: 91.97,   loss: 0.23381,   DP costs: 0.209,   average batch-size: 554,   best alpha: 65.38,   time: 65
INFO:root:iteration: 600,   train accuracy: 92.62,   test accuracy: 93.09,   loss: 0.36377,   DP costs: 0.23,   average batch-size: 510,   best alpha: 60.28,   time: 78
INFO:root:iteration: 700,   train accuracy: 93.45,   test accuracy: 93.46,   loss: 0.20767,   DP costs: 0.249,   average batch-size: 495,   best alpha: 56.27,   time: 90
INFO:root:iteration: 800,   train accuracy: 92.96,   test accuracy: 94.13,   loss: 0.29801,   DP costs: 0.267,   average batch-size: 500,   best alpha: 53.17,   time: 103
INFO:root:iteration: 900,   train accuracy: 93.14,   test accuracy: 94.58,   loss: 0.25387,   DP costs: 0.284,   average batch-size: 523,   best alpha: 50.44,   time: 116
INFO:root:iteration: 1000,   train accuracy: 93.8,   test accuracy: 94.58,   loss: 0.2116,   DP costs: 0.301,   average batch-size: 462,   best alpha: 48.06,   time: 128
INFO:root:iteration: 1100,   train accuracy: 95.14,   test accuracy: 95.09,   loss: 0.18287,   DP costs: 0.316,   average batch-size: 500,   best alpha: 46.16,   time: 140
INFO:root:iteration: 1200,   train accuracy: 94.75,   test accuracy: 95.36,   loss: 0.1796,   DP costs: 0.331,   average batch-size: 490,   best alpha: 44.33,   time: 153
INFO:root:iteration: 1300,   train accuracy: 94.69,   test accuracy: 95.35,   loss: 0.23037,   DP costs: 0.346,   average batch-size: 495,   best alpha: 42.75,   time: 166
INFO:root:iteration: 1400,   train accuracy: 95.12,   test accuracy: 95.64,   loss: 0.17593,   DP costs: 0.36,   average batch-size: 484,   best alpha: 41.4,   time: 178
INFO:root:iteration: 1500,   train accuracy: 95.48,   test accuracy: 95.68,   loss: 0.12893,   DP costs: 0.373,   average batch-size: 562,   best alpha: 40.25,   time: 192
INFO:root:iteration: 1600,   train accuracy: 94.79,   test accuracy: 95.74,   loss: 0.28895,   DP costs: 0.386,   average batch-size: 469,   best alpha: 38.97,   time: 204
INFO:root:iteration: 1700,   train accuracy: 95.87,   test accuracy: 95.88,   loss: 0.14644,   DP costs: 0.399,   average batch-size: 510,   best alpha: 38.05,   time: 216
INFO:root:iteration: 1800,   train accuracy: 95.9,   test accuracy: 95.85,   loss: 0.14784,   DP costs: 0.411,   average batch-size: 505,   best alpha: 36.99,   time: 228
INFO:root:iteration: 1900,   train accuracy: 95.17,   test accuracy: 95.92,   loss: 0.22451,   DP costs: 0.423,   average batch-size: 489,   best alpha: 36.11,   time: 241
INFO:root:iteration: 2000,   train accuracy: 95.31,   test accuracy: 96.01,   loss: 0.13138,   DP costs: 0.435,   average batch-size: 462,   best alpha: 35.4,   time: 253
INFO:root:iteration: 2100,   train accuracy: 96.58,   test accuracy: 96.16,   loss: 0.2071,   DP costs: 0.446,   average batch-size: 523,   best alpha: 34.56,   time: 266
INFO:root:iteration: 2200,   train accuracy: 95.48,   test accuracy: 96.3,   loss: 0.1493,   DP costs: 0.457,   average batch-size: 540,   best alpha: 33.87,   time: 278
INFO:root:iteration: 2300,   train accuracy: 95.97,   test accuracy: 96.36,   loss: 0.11833,   DP costs: 0.468,   average batch-size: 506,   best alpha: 33.2,   time: 290
INFO:root:iteration: 2400,   train accuracy: 96.51,   test accuracy: 96.18,   loss: 0.22462,   DP costs: 0.479,   average batch-size: 478,   best alpha: 32.54,   time: 302
INFO:root:iteration: 2500,   train accuracy: 95.98,   test accuracy: 96.2,   loss: 0.09812,   DP costs: 0.49,   average batch-size: 522,   best alpha: 32.03,   time: 315
INFO:root:iteration: 2600,   train accuracy: 96.05,   test accuracy: 96.32,   loss: 0.1897,   DP costs: 0.5,   average batch-size: 536,   best alpha: 31.39,   time: 328
INFO:root:iteration: 2700,   train accuracy: 95.97,   test accuracy: 96.34,   loss: 0.10158,   DP costs: 0.51,   average batch-size: 505,   best alpha: 30.9,   time: 341
INFO:root:iteration: 2800,   train accuracy: 96.1,   test accuracy: 96.41,   loss: 0.11915,   DP costs: 0.52,   average batch-size: 563,   best alpha: 30.41,   time: 354
INFO:root:iteration: 2900,   train accuracy: 96.69,   test accuracy: 96.41,   loss: 0.13642,   DP costs: 0.53,   average batch-size: 485,   best alpha: 29.93,   time: 367
INFO:root:iteration: 3000,   train accuracy: 96.0,   test accuracy: 96.47,   loss: 0.08075,   DP costs: 0.54,   average batch-size: 470,   best alpha: 29.45,   time: 378
INFO:root:iteration: 3100,   train accuracy: 96.6,   test accuracy: 96.58,   loss: 0.1437,   DP costs: 0.549,   average batch-size: 553,   best alpha: 29.1,   time: 391
INFO:root:iteration: 3200,   train accuracy: 95.98,   test accuracy: 96.62,   loss: 0.13517,   DP costs: 0.559,   average batch-size: 469,   best alpha: 28.64,   time: 403
INFO:root:iteration: 3300,   train accuracy: 96.22,   test accuracy: 96.62,   loss: 0.09845,   DP costs: 0.568,   average batch-size: 495,   best alpha: 28.3,   time: 416
INFO:root:iteration: 3400,   train accuracy: 96.19,   test accuracy: 96.66,   loss: 0.18673,   DP costs: 0.577,   average batch-size: 486,   best alpha: 27.86,   time: 429
INFO:root:iteration: 3500,   train accuracy: 96.52,   test accuracy: 96.71,   loss: 0.1079,   DP costs: 0.586,   average batch-size: 546,   best alpha: 27.53,   time: 441
INFO:root:iteration: 3600,   train accuracy: 95.84,   test accuracy: 96.64,   loss: 0.13839,   DP costs: 0.595,   average batch-size: 493,   best alpha: 27.2,   time: 454
INFO:root:iteration: 3700,   train accuracy: 96.19,   test accuracy: 96.8,   loss: 0.1783,   DP costs: 0.604,   average batch-size: 504,   best alpha: 26.88,   time: 467
INFO:root:iteration: 3800,   train accuracy: 96.89,   test accuracy: 96.66,   loss: 0.15072,   DP costs: 0.613,   average batch-size: 535,   best alpha: 26.56,   time: 479
INFO:root:iteration: 3900,   train accuracy: 97.27,   test accuracy: 96.83,   loss: 0.1678,   DP costs: 0.621,   average batch-size: 499,   best alpha: 26.25,   time: 492
INFO:root:iteration: 4000,   train accuracy: 95.81,   test accuracy: 96.85,   loss: 0.18955,   DP costs: 0.63,   average batch-size: 522,   best alpha: 25.94,   time: 505
INFO:root:iteration: 4100,   train accuracy: 97.08,   test accuracy: 96.77,   loss: 0.20224,   DP costs: 0.638,   average batch-size: 505,   best alpha: 25.63,   time: 518
INFO:root:iteration: 4200,   train accuracy: 96.15,   test accuracy: 96.86,   loss: 0.08868,   DP costs: 0.646,   average batch-size: 511,   best alpha: 25.43,   time: 531
INFO:root:iteration: 4300,   train accuracy: 96.66,   test accuracy: 96.94,   loss: 0.15788,   DP costs: 0.655,   average batch-size: 498,   best alpha: 25.13,   time: 543
INFO:root:iteration: 4400,   train accuracy: 96.33,   test accuracy: 96.94,   loss: 0.08404,   DP costs: 0.663,   average batch-size: 487,   best alpha: 24.83,   time: 555
INFO:root:iteration: 4500,   train accuracy: 96.26,   test accuracy: 96.87,   loss: 0.11493,   DP costs: 0.671,   average batch-size: 484,   best alpha: 24.63,   time: 568
INFO:root:iteration: 4600,   train accuracy: 97.03,   test accuracy: 96.78,   loss: 0.09391,   DP costs: 0.679,   average batch-size: 470,   best alpha: 24.34,   time: 580
INFO:root:iteration: 4700,   train accuracy: 96.36,   test accuracy: 96.69,   loss: 0.10225,   DP costs: 0.687,   average batch-size: 490,   best alpha: 24.15,   time: 592
INFO:root:iteration: 4800,   train accuracy: 96.36,   test accuracy: 96.79,   loss: 0.13976,   DP costs: 0.694,   average batch-size: 502,   best alpha: 23.96,   time: 605
INFO:root:iteration: 4900,   train accuracy: 96.75,   test accuracy: 96.83,   loss: 0.17551,   DP costs: 0.702,   average batch-size: 488,   best alpha: 23.68,   time: 616
INFO:root:iteration: 5000,   train accuracy: 96.67,   test accuracy: 96.78,   loss: 0.10959,   DP costs: 0.71,   average batch-size: 514,   best alpha: 23.49,   time: 629
INFO:root:iteration: 5100,   train accuracy: 96.37,   test accuracy: 96.73,   loss: 0.1423,   DP costs: 0.717,   average batch-size: 480,   best alpha: 23.31,   time: 642
INFO:root:iteration: 5200,   train accuracy: 96.74,   test accuracy: 96.86,   loss: 0.16922,   DP costs: 0.725,   average batch-size: 534,   best alpha: 23.13,   time: 654
INFO:root:iteration: 5300,   train accuracy: 96.47,   test accuracy: 96.75,   loss: 0.10337,   DP costs: 0.732,   average batch-size: 505,   best alpha: 22.85,   time: 667
INFO:root:iteration: 5400,   train accuracy: 96.56,   test accuracy: 96.81,   loss: 0.14127,   DP costs: 0.74,   average batch-size: 541,   best alpha: 22.67,   time: 680
INFO:root:iteration: 5500,   train accuracy: 96.73,   test accuracy: 96.82,   loss: 0.22815,   DP costs: 0.747,   average batch-size: 515,   best alpha: 22.5,   time: 693
INFO:root:iteration: 5600,   train accuracy: 96.59,   test accuracy: 96.86,   loss: 0.18741,   DP costs: 0.754,   average batch-size: 510,   best alpha: 22.32,   time: 701
INFO:root:iteration: 5700,   train accuracy: 97.77,   test accuracy: 96.89,   loss: 0.08483,   DP costs: 0.762,   average batch-size: 529,   best alpha: 22.14,   time: 708
INFO:root:iteration: 5800,   train accuracy: 95.57,   test accuracy: 96.91,   loss: 0.17546,   DP costs: 0.769,   average batch-size: 512,   best alpha: 21.97,   time: 715
INFO:root:iteration: 5900,   train accuracy: 96.87,   test accuracy: 97.02,   loss: 0.1379,   DP costs: 0.776,   average batch-size: 549,   best alpha: 21.8,   time: 722
INFO:root:iteration: 6000,   train accuracy: 96.5,   test accuracy: 96.89,   loss: 0.13765,   DP costs: 0.783,   average batch-size: 506,   best alpha: 21.63,   time: 729
INFO:root:iteration: 6100,   train accuracy: 96.15,   test accuracy: 96.91,   loss: 0.16576,   DP costs: 0.79,   average batch-size: 482,   best alpha: 21.54,   time: 736
INFO:root:iteration: 6200,   train accuracy: 97.0,   test accuracy: 96.97,   loss: 0.11273,   DP costs: 0.797,   average batch-size: 534,   best alpha: 21.37,   time: 743
INFO:root:iteration: 6300,   train accuracy: 96.08,   test accuracy: 96.85,   loss: 0.22524,   DP costs: 0.804,   average batch-size: 516,   best alpha: 21.21,   time: 750
INFO:root:iteration: 6400,   train accuracy: 97.03,   test accuracy: 96.94,   loss: 0.14708,   DP costs: 0.81,   average batch-size: 564,   best alpha: 21.04,   time: 758
INFO:root:iteration: 6500,   train accuracy: 96.51,   test accuracy: 96.91,   loss: 0.23824,   DP costs: 0.817,   average batch-size: 521,   best alpha: 20.88,   time: 765
INFO:root:iteration: 6600,   train accuracy: 96.72,   test accuracy: 97.01,   loss: 0.12007,   DP costs: 0.824,   average batch-size: 523,   best alpha: 20.79,   time: 772
INFO:root:iteration: 6700,   train accuracy: 96.73,   test accuracy: 96.92,   loss: 0.17528,   DP costs: 0.831,   average batch-size: 523,   best alpha: 20.63,   time: 779
INFO:root:iteration: 6800,   train accuracy: 97.21,   test accuracy: 97.01,   loss: 0.12739,   DP costs: 0.837,   average batch-size: 481,   best alpha: 20.47,   time: 789
INFO:root:iteration: 6900,   train accuracy: 96.56,   test accuracy: 96.94,   loss: 0.23142,   DP costs: 0.844,   average batch-size: 493,   best alpha: 20.39,   time: 796
INFO:root:iteration: 7000,   train accuracy: 96.66,   test accuracy: 96.92,   loss: 0.17592,   DP costs: 0.851,   average batch-size: 515,   best alpha: 20.23,   time: 803
INFO:root:iteration: 7100,   train accuracy: 97.29,   test accuracy: 96.93,   loss: 0.20467,   DP costs: 0.857,   average batch-size: 539,   best alpha: 20.07,   time: 810
INFO:root:iteration: 7200,   train accuracy: 96.87,   test accuracy: 96.99,   loss: 0.14205,   DP costs: 0.864,   average batch-size: 522,   best alpha: 19.99,   time: 817
INFO:root:iteration: 7300,   train accuracy: 97.02,   test accuracy: 97.08,   loss: 0.15972,   DP costs: 0.87,   average batch-size: 511,   best alpha: 19.84,   time: 825
INFO:root:iteration: 7400,   train accuracy: 96.76,   test accuracy: 96.89,   loss: 0.13446,   DP costs: 0.876,   average batch-size: 502,   best alpha: 19.76,   time: 834
INFO:root:iteration: 7500,   train accuracy: 96.23,   test accuracy: 96.95,   loss: 0.18559,   DP costs: 0.883,   average batch-size: 484,   best alpha: 19.61,   time: 841
INFO:root:iteration: 7600,   train accuracy: 96.53,   test accuracy: 96.95,   loss: 0.17491,   DP costs: 0.889,   average batch-size: 479,   best alpha: 19.53,   time: 848
INFO:root:iteration: 7700,   train accuracy: 96.81,   test accuracy: 96.88,   loss: 0.08242,   DP costs: 0.895,   average batch-size: 531,   best alpha: 19.38,   time: 855
INFO:root:iteration: 7800,   train accuracy: 97.0,   test accuracy: 96.93,   loss: 0.0903,   DP costs: 0.902,   average batch-size: 512,   best alpha: 19.3,   time: 862
INFO:root:iteration: 7900,   train accuracy: 96.8,   test accuracy: 96.9,   loss: 0.19501,   DP costs: 0.908,   average batch-size: 502,   best alpha: 19.15,   time: 869
INFO:root:iteration: 8000,   train accuracy: 96.99,   test accuracy: 96.77,   loss: 0.05635,   DP costs: 0.914,   average batch-size: 503,   best alpha: 19.08,   time: 876
INFO:root:iteration: 8100,   train accuracy: 96.89,   test accuracy: 96.82,   loss: 0.12276,   DP costs: 0.92,   average batch-size: 506,   best alpha: 18.93,   time: 884
INFO:root:iteration: 8200,   train accuracy: 96.2,   test accuracy: 96.76,   loss: 0.17161,   DP costs: 0.926,   average batch-size: 511,   best alpha: 18.85,   time: 891
INFO:root:iteration: 8300,   train accuracy: 96.85,   test accuracy: 96.81,   loss: 0.17244,   DP costs: 0.932,   average batch-size: 504,   best alpha: 18.78,   time: 901
INFO:root:iteration: 8400,   train accuracy: 97.13,   test accuracy: 96.84,   loss: 0.16403,   DP costs: 0.938,   average batch-size: 520,   best alpha: 18.64,   time: 908
INFO:root:iteration: 8500,   train accuracy: 96.79,   test accuracy: 96.82,   loss: 0.06078,   DP costs: 0.945,   average batch-size: 578,   best alpha: 18.56,   time: 915
INFO:root:iteration: 8600,   train accuracy: 96.84,   test accuracy: 96.86,   loss: 0.12108,   DP costs: 0.951,   average batch-size: 516,   best alpha: 18.49,   time: 922
INFO:root:iteration: 8700,   train accuracy: 96.14,   test accuracy: 97.02,   loss: 0.09262,   DP costs: 0.956,   average batch-size: 530,   best alpha: 18.35,   time: 929
INFO:root:iteration: 8800,   train accuracy: 97.54,   test accuracy: 97.03,   loss: 0.12633,   DP costs: 0.962,   average batch-size: 480,   best alpha: 18.28,   time: 936
INFO:root:iteration: 8900,   train accuracy: 97.04,   test accuracy: 96.93,   loss: 0.16888,   DP costs: 0.968,   average batch-size: 509,   best alpha: 18.2,   time: 943
INFO:root:iteration: 9000,   train accuracy: 96.66,   test accuracy: 96.87,   loss: 0.12736,   DP costs: 0.974,   average batch-size: 483,   best alpha: 18.13,   time: 950
INFO:root:iteration: 9100,   train accuracy: 96.51,   test accuracy: 96.92,   loss: 0.07162,   DP costs: 0.98,   average batch-size: 518,   best alpha: 17.99,   time: 957
INFO:root:iteration: 9200,   train accuracy: 96.79,   test accuracy: 96.99,   loss: 0.13247,   DP costs: 0.986,   average batch-size: 511,   best alpha: 17.92,   time: 964
INFO:root:iteration: 9300,   train accuracy: 97.04,   test accuracy: 96.89,   loss: 0.07834,   DP costs: 0.992,   average batch-size: 487,   best alpha: 17.85,   time: 971
INFO:root:iteration: 9374,   train accuracy: 96.57,   test accuracy: 96.97,   loss: 0.19805,   DP costs: 0.996,   average batch-size: 547,   best alpha: 17.78,   time: 978
INFO:root:Terminate: The maximum of iterations is reached!
