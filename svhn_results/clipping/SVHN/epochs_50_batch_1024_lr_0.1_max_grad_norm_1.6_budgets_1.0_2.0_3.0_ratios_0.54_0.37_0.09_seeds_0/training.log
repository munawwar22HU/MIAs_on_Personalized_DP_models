INFO:root:Input args: Namespace(dname='SVHN', seeds=[0], architecture='CIFAR10_CNN', accountant='rdp', individualize='clipping', log_iteration=100, lr=0.1, momentum=0.5, epochs=50, n_workers=6, batch_size=1024, max_physical_batch_size=1024, delta=1e-05, budgets=[1.0, 2.0, 3.0], ratios=[0.54, 0.37, 0.09], max_grad_norm=1.6, noise_multiplier=2.45703, weights=None, adapt_weights_to_budgets=True, use_cuda='True', save_path='../svhn_results/clipping/SVHN/epochs_50_batch_1024_lr_0.1_max_grad_norm_1.6_budgets_1.0_2.0_3.0_ratios_0.54_0.37_0.09_seeds_0', mode='mia', accuracy_log='accuracy.log', assign_budget='random', class_budgets=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], mia_ndata=73257, mia_count=0, allow_excess=False, save_model='True')
INFO:root:seed: 0,   max_iteration: 3577,   1 epoch ~= 72 iterations
INFO:root:seed: 0,   max_iteration: 3577,   1 epoch ~= 72 iterations
INFO:root:Initializing privacy parameters:   max_grad_norm=1.6,   sample_rate=0.013888888888888888,   noise_multiplier 2.729961525914333,   individual max_grad_norms=[1.2563957764207987, 2.237783096464312, 3.0145030928782095]
INFO:root:iteration: 0,   train accuracy: 11.01,   test accuracy: 10.06,   loss: 2.30244,   DP costs: [0.059, 0.224, 0.446],   average batch-size: 923,   best alpha: [102.95, 32.85, 18.44],   time: 2
INFO:root:iteration: 100,   train accuracy: 19.06,   test accuracy: 19.59,   loss: 2.25169,   DP costs: [0.152, 0.341, 0.607],   average batch-size: 1035,   best alpha: [83.26, 31.56, 17.18],   time: 32
INFO:root:iteration: 200,   train accuracy: 28.73,   test accuracy: 28.96,   loss: 2.16063,   DP costs: [0.217, 0.447, 0.732],   average batch-size: 928,   best alpha: [62.38, 30.94, 16.85],   time: 60
INFO:root:iteration: 300,   train accuracy: 39.88,   test accuracy: 40.27,   loss: 1.76079,   DP costs: [0.268, 0.545, 0.851],   average batch-size: 1132,   best alpha: [52.41, 27.67, 16.52],   time: 92
INFO:root:iteration: 400,   train accuracy: 49.29,   test accuracy: 50.74,   loss: 1.61132,   DP costs: [0.311, 0.63, 0.966],   average batch-size: 1003,   best alpha: [46.24, 24.67, 16.08],   time: 121
INFO:root:iteration: 500,   train accuracy: 58.92,   test accuracy: 60.08,   loss: 1.32469,   DP costs: [0.35, 0.706, 1.075],   average batch-size: 981,   best alpha: [41.97, 22.62, 15.29],   time: 150
INFO:root:iteration: 600,   train accuracy: 66.77,   test accuracy: 68.47,   loss: 1.0752,   DP costs: [0.385, 0.776, 1.177],   average batch-size: 1031,   best alpha: [38.89, 20.99, 14.38],   time: 180
INFO:root:iteration: 700,   train accuracy: 71.29,   test accuracy: 72.31,   loss: 0.86992,   DP costs: [0.418, 0.84, 1.271],   average batch-size: 1019,   best alpha: [36.32, 19.71, 13.63],   time: 209
INFO:root:iteration: 800,   train accuracy: 73.89,   test accuracy: 75.32,   loss: 0.8638,   DP costs: [0.448, 0.9, 1.36],   average batch-size: 1030,   best alpha: [34.2, 18.66, 12.97],   time: 239
INFO:root:iteration: 900,   train accuracy: 76.67,   test accuracy: 77.42,   loss: 0.76793,   DP costs: [0.477, 0.957, 1.444],   average batch-size: 986,   best alpha: [32.47, 17.81, 12.39],   time: 268
INFO:root:iteration: 1000,   train accuracy: 79.12,   test accuracy: 78.74,   loss: 0.77678,   DP costs: [0.504, 1.011, 1.524],   average batch-size: 969,   best alpha: [31.07, 17.0, 11.93],   time: 296
INFO:root:iteration: 1100,   train accuracy: 79.68,   test accuracy: 79.74,   loss: 0.71227,   DP costs: [0.53, 1.063, 1.601],   average batch-size: 981,   best alpha: [29.74, 16.35, 11.49],   time: 325
INFO:root:iteration: 1200,   train accuracy: 81.15,   test accuracy: 80.6,   loss: 0.72954,   DP costs: [0.555, 1.113, 1.675],   average batch-size: 1011,   best alpha: [28.58, 15.79, 11.11],   time: 354
INFO:root:iteration: 1300,   train accuracy: 81.79,   test accuracy: 81.07,   loss: 0.63139,   DP costs: [0.58, 1.161, 1.746],   average batch-size: 1019,   best alpha: [27.68, 15.25, 10.78],   time: 383
INFO:root:iteration: 1400,   train accuracy: 82.58,   test accuracy: 81.8,   loss: 0.64481,   DP costs: [0.603, 1.207, 1.815],   average batch-size: 988,   best alpha: [26.71, 14.79, 10.5],   time: 412
INFO:root:iteration: 1500,   train accuracy: 82.89,   test accuracy: 82.29,   loss: 0.57258,   DP costs: [0.625, 1.252, 1.881],   average batch-size: 980,   best alpha: [25.98, 14.4, 10.19],   time: 441
INFO:root:iteration: 1600,   train accuracy: 84.02,   test accuracy: 82.43,   loss: 0.69392,   DP costs: [0.647, 1.295, 1.946],   average batch-size: 1060,   best alpha: [25.27, 14.02, 9.97],   time: 472
INFO:root:iteration: 1700,   train accuracy: 84.04,   test accuracy: 83.03,   loss: 0.63745,   DP costs: [0.669, 1.338, 2.009],   average batch-size: 1006,   best alpha: [24.58, 13.65, 9.71],   time: 501
INFO:root:iteration: 1800,   train accuracy: 84.55,   test accuracy: 83.32,   loss: 0.573,   DP costs: [0.689, 1.379, 2.07],   average batch-size: 1001,   best alpha: [23.91, 13.34, 9.5],   time: 530
INFO:root:iteration: 1900,   train accuracy: 84.21,   test accuracy: 83.3,   loss: 0.51364,   DP costs: [0.71, 1.419, 2.13],   average batch-size: 1007,   best alpha: [23.35, 13.04, 9.33],   time: 559
INFO:root:iteration: 2000,   train accuracy: 84.66,   test accuracy: 83.59,   loss: 0.59401,   DP costs: [0.729, 1.458, 2.189],   average batch-size: 1037,   best alpha: [22.89, 12.79, 9.12],   time: 589
INFO:root:iteration: 2100,   train accuracy: 85.22,   test accuracy: 83.89,   loss: 0.58013,   DP costs: [0.749, 1.497, 2.246],   average batch-size: 1076,   best alpha: [22.36, 12.5, 8.96],   time: 620
INFO:root:iteration: 2200,   train accuracy: 85.19,   test accuracy: 84.06,   loss: 0.61502,   DP costs: [0.767, 1.535, 2.302],   average batch-size: 1036,   best alpha: [21.92, 12.27, 8.8],   time: 650
INFO:root:iteration: 2300,   train accuracy: 85.62,   test accuracy: 84.35,   loss: 0.56233,   DP costs: [0.786, 1.571, 2.358],   average batch-size: 1109,   best alpha: [21.49, 12.04, 8.67],   time: 680
INFO:root:iteration: 2400,   train accuracy: 85.49,   test accuracy: 84.48,   loss: 0.68591,   DP costs: [0.804, 1.608, 2.412],   average batch-size: 967,   best alpha: [21.08, 11.86, 8.51],   time: 709
INFO:root:iteration: 2500,   train accuracy: 85.59,   test accuracy: 84.49,   loss: 0.56928,   DP costs: [0.822, 1.643, 2.465],   average batch-size: 972,   best alpha: [20.75, 11.63, 8.39],   time: 738
INFO:root:iteration: 2600,   train accuracy: 85.34,   test accuracy: 84.74,   loss: 0.6309,   DP costs: [0.839, 1.678, 2.517],   average batch-size: 991,   best alpha: [20.35, 11.46, 8.27],   time: 766
INFO:root:iteration: 2700,   train accuracy: 85.81,   test accuracy: 84.61,   loss: 0.60987,   DP costs: [0.857, 1.713, 2.569],   average batch-size: 954,   best alpha: [20.03, 11.29, 8.12],   time: 795
INFO:root:iteration: 2800,   train accuracy: 85.66,   test accuracy: 84.8,   loss: 0.53029,   DP costs: [0.873, 1.746, 2.619],   average batch-size: 1033,   best alpha: [19.72, 11.12, 8.03],   time: 824
INFO:root:iteration: 2900,   train accuracy: 86.15,   test accuracy: 84.86,   loss: 0.61121,   DP costs: [0.89, 1.78, 2.669],   average batch-size: 1055,   best alpha: [19.41, 10.96, 7.92],   time: 855
INFO:root:iteration: 3000,   train accuracy: 85.7,   test accuracy: 84.97,   loss: 0.89663,   DP costs: [0.906, 1.812, 2.718],   average batch-size: 1049,   best alpha: [19.11, 10.79, 7.8],   time: 884
INFO:root:iteration: 3100,   train accuracy: 86.26,   test accuracy: 84.87,   loss: 0.55891,   DP costs: [0.922, 1.845, 2.767],   average batch-size: 1005,   best alpha: [18.89, 10.67, 7.72],   time: 913
INFO:root:iteration: 3200,   train accuracy: 86.51,   test accuracy: 84.7,   loss: 0.44945,   DP costs: [0.938, 1.877, 2.815],   average batch-size: 993,   best alpha: [18.59, 10.51, 7.61],   time: 942
INFO:root:iteration: 3300,   train accuracy: 86.08,   test accuracy: 84.63,   loss: 0.55261,   DP costs: [0.954, 1.908, 2.862],   average batch-size: 982,   best alpha: [18.38, 10.4, 7.53],   time: 970
INFO:root:iteration: 3400,   train accuracy: 85.9,   test accuracy: 84.83,   loss: 0.50341,   DP costs: [0.969, 1.939, 2.909],   average batch-size: 985,   best alpha: [18.09, 10.24, 7.45],   time: 999
INFO:root:iteration: 3500,   train accuracy: 86.17,   test accuracy: 85.03,   loss: 0.49341,   DP costs: [0.985, 1.97, 2.955],   average batch-size: 981,   best alpha: [17.88, 10.13, 7.37],   time: 1028
INFO:root:iteration: 3576,   train accuracy: 85.97,   test accuracy: 85.11,   loss: 0.43024,   DP costs: [0.996, 1.993, 2.989],   average batch-size: 963,   best alpha: [17.68, 10.05, 7.29],   time: 1051
INFO:root:Terminate: The maximum of iterations is reached!
