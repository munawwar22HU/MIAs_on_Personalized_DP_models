INFO:root:Input args: Namespace(dname='SVHN', seeds=[0], architecture='CIFAR10_CNN', accountant='rdp', individualize='sampling', log_iteration=100, lr=0.2, momentum=0.5, epochs=80, n_workers=6, batch_size=1024, max_physical_batch_size=1024, delta=1e-05, budgets=[1.0, 2.0, 3.0], ratios=[0.34, 0.43, 0.23], max_grad_norm=0.6, noise_multiplier=2.53261, weights=None, adapt_weights_to_budgets=True, use_cuda='True', save_path='../svhn_results/sampling/SVHN/epochs_80_batch_1024_lr_0.2_max_grad_norm_0.6_budgets_1.0_2.0_3.0_ratios_0.34_0.43_0.23_seeds_0', mode='mia', accuracy_log='accuracy.log', assign_budget='random', class_budgets=[1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], mia_ndata=73257, mia_count=0, allow_excess=False, save_model='True')
INFO:root:seed: 0,   max_iteration: 5723,   1 epoch ~= 72 iterations
INFO:root:seed: 0,   max_iteration: 5723,   1 epoch ~= 72 iterations
INFO:root:Initializing privacy parameters:   max_grad_norm=0.6,   sample_rate=0.013888888888888888,   noise_multiplier 2.532611694335938,   individual sample_rates=[0.007836914984130859, 0.014758301633666992, 0.021252442193725588]
INFO:root:iteration: 0,   train accuracy: 10.85,   test accuracy: 10.05,   loss: 2.3,   DP costs: [0.105, 0.125, 0.14],   average batch-size: 929,   best alpha: [62.36, 54.06, 49.33],   time: 2
INFO:root:iteration: 100,   train accuracy: 19.01,   test accuracy: 19.59,   loss: 2.24134,   DP costs: [0.142, 0.24, 0.356],   average batch-size: 1066,   best alpha: [61.35, 52.34, 39.2],   time: 33
INFO:root:iteration: 200,   train accuracy: 18.73,   test accuracy: 19.59,   loss: 2.24496,   DP costs: [0.176, 0.339, 0.503],   average batch-size: 977,   best alpha: [61.1, 41.75, 29.86],   time: 61
INFO:root:iteration: 300,   train accuracy: 19.12,   test accuracy: 19.59,   loss: 2.25393,   DP costs: [0.211, 0.417, 0.619],   average batch-size: 1148,   best alpha: [60.61, 35.41, 25.37],   time: 93
INFO:root:iteration: 400,   train accuracy: 18.84,   test accuracy: 19.59,   loss: 2.2245,   DP costs: [0.244, 0.484, 0.718],   average batch-size: 967,   best alpha: [56.35, 31.41, 22.53],   time: 122
INFO:root:iteration: 500,   train accuracy: 18.58,   test accuracy: 19.59,   loss: 2.25263,   DP costs: [0.274, 0.543, 0.806],   average batch-size: 968,   best alpha: [51.13, 28.66, 20.58],   time: 151
INFO:root:iteration: 600,   train accuracy: 19.07,   test accuracy: 19.59,   loss: 2.23871,   DP costs: [0.301, 0.597, 0.886],   average batch-size: 1074,   best alpha: [47.35, 26.47, 19.03],   time: 181
INFO:root:iteration: 700,   train accuracy: 18.98,   test accuracy: 19.59,   loss: 2.20801,   DP costs: [0.326, 0.647, 0.961],   average batch-size: 998,   best alpha: [44.39, 24.84, 17.88],   time: 210
INFO:root:iteration: 800,   train accuracy: 18.78,   test accuracy: 19.59,   loss: 2.25141,   DP costs: [0.35, 0.694, 1.031],   average batch-size: 1024,   best alpha: [41.79, 23.41, 16.87],   time: 239
INFO:root:iteration: 900,   train accuracy: 18.93,   test accuracy: 19.59,   loss: 2.21504,   DP costs: [0.372, 0.738, 1.097],   average batch-size: 993,   best alpha: [39.82, 22.33, 16.04],   time: 268
INFO:root:iteration: 1000,   train accuracy: 18.8,   test accuracy: 19.59,   loss: 2.22417,   DP costs: [0.394, 0.781, 1.16],   average batch-size: 1027,   best alpha: [37.95, 21.3, 15.37],   time: 297
INFO:root:iteration: 1100,   train accuracy: 18.93,   test accuracy: 19.59,   loss: 2.25748,   DP costs: [0.414, 0.821, 1.22],   average batch-size: 1051,   best alpha: [36.45, 20.48, 14.79],   time: 327
INFO:root:iteration: 1200,   train accuracy: 19.17,   test accuracy: 19.59,   loss: 2.25676,   DP costs: [0.433, 0.859, 1.278],   average batch-size: 1061,   best alpha: [35.02, 19.69, 14.24],   time: 357
INFO:root:iteration: 1300,   train accuracy: 18.96,   test accuracy: 19.59,   loss: 2.24103,   DP costs: [0.452, 0.897, 1.334],   average batch-size: 1015,   best alpha: [33.92, 19.09, 13.75],   time: 386
INFO:root:iteration: 1400,   train accuracy: 18.91,   test accuracy: 19.59,   loss: 2.24509,   DP costs: [0.47, 0.933, 1.388],   average batch-size: 992,   best alpha: [32.85, 18.5, 13.34],   time: 415
INFO:root:iteration: 1500,   train accuracy: 18.97,   test accuracy: 19.59,   loss: 2.2358,   DP costs: [0.487, 0.967, 1.44],   average batch-size: 1009,   best alpha: [31.82, 17.93, 12.99],   time: 444
INFO:root:iteration: 1600,   train accuracy: 18.82,   test accuracy: 19.58,   loss: 2.24845,   DP costs: [0.504, 1.001, 1.491],   average batch-size: 1021,   best alpha: [30.94, 17.45, 12.6],   time: 474
INFO:root:iteration: 1700,   train accuracy: 19.04,   test accuracy: 19.59,   loss: 2.23481,   DP costs: [0.521, 1.034, 1.54],   average batch-size: 908,   best alpha: [30.09, 16.98, 12.32],   time: 501
INFO:root:iteration: 1800,   train accuracy: 18.84,   test accuracy: 19.59,   loss: 2.24443,   DP costs: [0.537, 1.066, 1.588],   average batch-size: 1020,   best alpha: [29.38, 16.59, 11.99],   time: 530
INFO:root:iteration: 1900,   train accuracy: 19.0,   test accuracy: 19.58,   loss: 2.21245,   DP costs: [0.552, 1.097, 1.635],   average batch-size: 963,   best alpha: [28.68, 16.21, 11.73],   time: 558
INFO:root:iteration: 2000,   train accuracy: 18.79,   test accuracy: 19.59,   loss: 2.22941,   DP costs: [0.567, 1.128, 1.681],   average batch-size: 982,   best alpha: [28.12, 15.84, 11.51],   time: 587
INFO:root:iteration: 2100,   train accuracy: 19.19,   test accuracy: 19.58,   loss: 2.22369,   DP costs: [0.582, 1.158, 1.725],   average batch-size: 1038,   best alpha: [27.46, 15.53, 11.25],   time: 617
INFO:root:iteration: 2200,   train accuracy: 19.09,   test accuracy: 19.59,   loss: 2.20963,   DP costs: [0.597, 1.187, 1.769],   average batch-size: 1073,   best alpha: [26.92, 15.24, 11.04],   time: 647
INFO:root:iteration: 2300,   train accuracy: 18.9,   test accuracy: 19.59,   loss: 2.2444,   DP costs: [0.611, 1.215, 1.812],   average batch-size: 1118,   best alpha: [26.39, 14.95, 10.84],   time: 679
INFO:root:iteration: 2400,   train accuracy: 18.9,   test accuracy: 19.59,   loss: 2.24657,   DP costs: [0.625, 1.244, 1.855],   average batch-size: 1026,   best alpha: [25.87, 14.66, 10.68],   time: 708
INFO:root:iteration: 2500,   train accuracy: 19.09,   test accuracy: 19.59,   loss: 2.24735,   DP costs: [0.639, 1.271, 1.896],   average batch-size: 1012,   best alpha: [25.46, 14.38, 10.48],   time: 737
INFO:root:iteration: 2600,   train accuracy: 18.85,   test accuracy: 19.59,   loss: 2.23331,   DP costs: [0.652, 1.298, 1.937],   average batch-size: 1001,   best alpha: [25.06, 14.17, 10.32],   time: 766
INFO:root:iteration: 2700,   train accuracy: 18.95,   test accuracy: 19.57,   loss: 2.25403,   DP costs: [0.666, 1.325, 1.977],   average batch-size: 947,   best alpha: [24.57, 13.95, 10.13],   time: 794
INFO:root:iteration: 2800,   train accuracy: 18.68,   test accuracy: 19.59,   loss: 2.24961,   DP costs: [0.679, 1.351, 2.016],   average batch-size: 1001,   best alpha: [24.18, 13.74, 9.98],   time: 823
INFO:root:iteration: 2900,   train accuracy: 18.88,   test accuracy: 19.6,   loss: 2.23953,   DP costs: [0.691, 1.377, 2.055],   average batch-size: 1113,   best alpha: [23.81, 13.53, 9.84],   time: 854
INFO:root:iteration: 3000,   train accuracy: 18.85,   test accuracy: 19.56,   loss: 2.27262,   DP costs: [0.704, 1.402, 2.094],   average batch-size: 1027,   best alpha: [23.53, 13.32, 9.73],   time: 883
INFO:root:iteration: 3100,   train accuracy: 19.16,   test accuracy: 19.57,   loss: 2.21707,   DP costs: [0.716, 1.427, 2.131],   average batch-size: 999,   best alpha: [23.16, 13.12, 9.58],   time: 913
INFO:root:iteration: 3200,   train accuracy: 18.87,   test accuracy: 19.59,   loss: 2.23064,   DP costs: [0.729, 1.452, 2.169],   average batch-size: 1020,   best alpha: [22.79, 12.97, 9.44],   time: 942
INFO:root:iteration: 3300,   train accuracy: 18.91,   test accuracy: 19.55,   loss: 2.23794,   DP costs: [0.741, 1.476, 2.205],   average batch-size: 969,   best alpha: [22.53, 12.83, 9.34],   time: 970
INFO:root:iteration: 3400,   train accuracy: 18.69,   test accuracy: 19.58,   loss: 2.20619,   DP costs: [0.753, 1.5, 2.242],   average batch-size: 1031,   best alpha: [22.26, 12.63, 9.24],   time: 1000
INFO:root:iteration: 3500,   train accuracy: 18.61,   test accuracy: 19.57,   loss: 2.27926,   DP costs: [0.764, 1.524, 2.277],   average batch-size: 1048,   best alpha: [21.91, 12.49, 9.1],   time: 1030
INFO:root:iteration: 3600,   train accuracy: 18.56,   test accuracy: 19.54,   loss: 2.26138,   DP costs: [0.776, 1.547, 2.313],   average batch-size: 1013,   best alpha: [21.66, 12.35, 9.0],   time: 1060
INFO:root:iteration: 3700,   train accuracy: 18.91,   test accuracy: 19.59,   loss: 2.21629,   DP costs: [0.788, 1.57, 2.348],   average batch-size: 1097,   best alpha: [21.4, 12.21, 8.9],   time: 1091
INFO:root:iteration: 3800,   train accuracy: 18.83,   test accuracy: 19.53,   loss: 2.26735,   DP costs: [0.799, 1.593, 2.382],   average batch-size: 1013,   best alpha: [21.15, 12.07, 8.81],   time: 1121
INFO:root:iteration: 3900,   train accuracy: 19.02,   test accuracy: 19.49,   loss: 2.24604,   DP costs: [0.81, 1.616, 2.416],   average batch-size: 1012,   best alpha: [20.9, 11.94, 8.71],   time: 1151
INFO:root:iteration: 4000,   train accuracy: 19.02,   test accuracy: 19.59,   loss: 2.23394,   DP costs: [0.821, 1.638, 2.45],   average batch-size: 1061,   best alpha: [20.74, 11.8, 8.62],   time: 1186
INFO:root:iteration: 4100,   train accuracy: 18.95,   test accuracy: 19.57,   loss: 2.19578,   DP costs: [0.832, 1.66, 2.484],   average batch-size: 1026,   best alpha: [20.5, 11.67, 8.55],   time: 1216
INFO:root:iteration: 4200,   train accuracy: 18.8,   test accuracy: 19.6,   loss: 2.23007,   DP costs: [0.843, 1.682, 2.517],   average batch-size: 1101,   best alpha: [20.26, 11.54, 8.46],   time: 1247
INFO:root:iteration: 4300,   train accuracy: 18.73,   test accuracy: 19.6,   loss: 2.24081,   DP costs: [0.853, 1.703, 2.55],   average batch-size: 1015,   best alpha: [20.02, 11.45, 8.37],   time: 1276
INFO:root:iteration: 4400,   train accuracy: 19.03,   test accuracy: 19.62,   loss: 2.22375,   DP costs: [0.864, 1.725, 2.582],   average batch-size: 1096,   best alpha: [19.87, 11.32, 8.31],   time: 1307
INFO:root:iteration: 4500,   train accuracy: 18.97,   test accuracy: 19.69,   loss: 2.26671,   DP costs: [0.875, 1.746, 2.614],   average batch-size: 1021,   best alpha: [19.63, 11.24, 8.22],   time: 1336
INFO:root:iteration: 4600,   train accuracy: 18.72,   test accuracy: 19.68,   loss: 2.262,   DP costs: [0.885, 1.767, 2.646],   average batch-size: 995,   best alpha: [19.48, 11.11, 8.16],   time: 1365
INFO:root:iteration: 4700,   train accuracy: 18.81,   test accuracy: 19.57,   loss: 2.23439,   DP costs: [0.895, 1.788, 2.678],   average batch-size: 1055,   best alpha: [19.33, 11.03, 8.07],   time: 1395
INFO:root:iteration: 4800,   train accuracy: 18.68,   test accuracy: 19.57,   loss: 2.23184,   DP costs: [0.905, 1.808, 2.709],   average batch-size: 1037,   best alpha: [19.1, 10.91, 8.01],   time: 1425
INFO:root:iteration: 4900,   train accuracy: 18.97,   test accuracy: 19.61,   loss: 2.22908,   DP costs: [0.915, 1.829, 2.74],   average batch-size: 1019,   best alpha: [18.95, 10.82, 7.93],   time: 1454
INFO:root:iteration: 5000,   train accuracy: 19.18,   test accuracy: 19.65,   loss: 2.25389,   DP costs: [0.925, 1.849, 2.77],   average batch-size: 1039,   best alpha: [18.81, 10.74, 7.87],   time: 1484
INFO:root:iteration: 5100,   train accuracy: 19.0,   test accuracy: 19.64,   loss: 2.24895,   DP costs: [0.935, 1.869, 2.801],   average batch-size: 1052,   best alpha: [18.59, 10.66, 7.81],   time: 1514
INFO:root:iteration: 5200,   train accuracy: 18.99,   test accuracy: 19.64,   loss: 2.2212,   DP costs: [0.945, 1.889, 2.831],   average batch-size: 1016,   best alpha: [18.44, 10.54, 7.76],   time: 1544
INFO:root:iteration: 5300,   train accuracy: 19.0,   test accuracy: 19.57,   loss: 2.22778,   DP costs: [0.955, 1.909, 2.861],   average batch-size: 1059,   best alpha: [18.3, 10.47, 7.7],   time: 1574
INFO:root:iteration: 5400,   train accuracy: 18.88,   test accuracy: 19.55,   loss: 2.22425,   DP costs: [0.964, 1.928, 2.891],   average batch-size: 1098,   best alpha: [18.16, 10.39, 7.62],   time: 1605
INFO:root:iteration: 5500,   train accuracy: 18.96,   test accuracy: 19.59,   loss: 2.22398,   DP costs: [0.974, 1.948, 2.92],   average batch-size: 1003,   best alpha: [18.02, 10.31, 7.57],   time: 1634
INFO:root:iteration: 5600,   train accuracy: 19.1,   test accuracy: 19.47,   loss: 2.24036,   DP costs: [0.984, 1.967, 2.95],   average batch-size: 1083,   best alpha: [17.88, 10.23, 7.51],   time: 1664
INFO:root:iteration: 5700,   train accuracy: 18.93,   test accuracy: 19.59,   loss: 2.2273,   DP costs: [0.993, 1.986, 2.979],   average batch-size: 1060,   best alpha: [17.74, 10.16, 7.46],   time: 1695
INFO:root:iteration: 5722,   train accuracy: 19.3,   test accuracy: 19.49,   loss: 2.21478,   DP costs: [0.995, 1.99, 2.985],   average batch-size: 1067,   best alpha: [17.67, 10.16, 7.46],   time: 1708
INFO:root:Terminate: The maximum of iterations is reached!
